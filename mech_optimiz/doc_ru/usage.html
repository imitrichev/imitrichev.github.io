<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>mech_optimiz: Использование mech_optimiz</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Mech-2.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mech_optimiz
   &#160;<span id="projectnumber">4.4.1</span>
   </div>
   <div id="projectbrief">microkinetic mechanism investigation tool</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Создано системой Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Поиск');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Титульная&#160;страница</span></a></li>
      <li class="current"><a href="pages.html"><span>Описания</span></a></li>
      <li><a href="files.html"><span>Файлы</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Поиск" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('usage.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Использование mech_optimiz </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Оглавление</h3>
<ul><li class="level1"><a href="#use0">Идея и общая логика программы</a></li>
<li class="level1"><a href="#use1">Режим подбора кинетических параметров</a><ul><li class="level2"><a href="#use1_1">Строка запуска</a></li>
<li class="level2"><a href="#use1_2">Синтаксис конфигурационного файла</a><ul><li class="level3"><a href="#commentaries">Комментарии в файле настроек</a></li>
<li class="level3"><a href="#use1_2_1">Первая строка</a></li>
<li class="level3"><a href="#use1_2_2">Cтрока параметров запуска</a></li>
<li class="level3"><a href="#use1_2_3">Строка CASE</a></li>
<li class="level3"><a href="#use1_2_4">Строка CONVERSION</a></li>
<li class="level3"><a href="#use1_2_5">Строка ENTROPY PRODUCTION</a></li>
<li class="level3"><a href="#use1_2_6">Строка ADDEQUATIONS</a></li>
<li class="level3"><a href="#use1_2_7">Строка ADDPARAMS</a></li>
<li class="level3"><a href="#use1_2_8">Строки MEAN_COVERAGES, DBNAME, WRITEBOUNDARIES</a></li>
<li class="level3"><a href="#use1_2_9">Строка MOVE_BOUNDARIES</a></li>
<li class="level3"><a href="#use1_2_10">Строка RESPECT_BOUNDARIES</a></li>
<li class="level3"><a href="#use1_2_11">Строка USE_SOBOL_NUMBERS</a></li>
<li class="level3"><a href="#use1_2_12">Строка UNITS</a></li>
<li class="level3"><a href="#use1_2_13">Строка SELECTIVITY_ANALYSIS</a></li>
<li class="level3"><a href="#use1_2_14">Строка NO_TC</a></li>
<li class="level3"><a href="#use1_2_15">Строка CHECK_LIMITATIONS_LEVEL</a></li>
<li class="level3"><a href="#use1_2_par">Строка PARAMETERS</a></li>
<li class="level3"><a href="#use1_2_act">Строка ACTIVITY</a></li>
</ul>
</li>
<li class="level2"><a href="#use1_3">Синтаксис save-файла</a></li>
<li class="level2"><a href="#use1_4">Синтаксис файла с кинетическим механизмом (газофазные реакции)</a></li>
<li class="level2"><a href="#use1_5">Синтаксис файла с кинетическим механизмом (поверхностные реакции)</a></li>
<li class="level2"><a href="#use1_6">Синтаксис файла с термодинамическими данными (поверхностные частицы)</a></li>
<li class="level2"><a href="#use1_7">Синтаксис файла с термодинамическими данными (thermo.dat)</a></li>
<li class="level2"><a href="#use1_8">Синтаксис файла с параметрами алгоритма обеспечения термодинамической непротиворечивости</a></li>
<li class="level2"><a href="#use1_9">Другие файлы, которые должны находиться в папке запуска для работы программы</a><ul><li class="level3"><a href="#use1_9_1">Файлы, используемые моделью CSTRCASCADE</a></li>
<li class="level3"><a href="#use1_9_2">Общие файлы</a></li>
</ul>
</li>
<li class="level2"><a href="#use1_10">Файлы, производимые программой при работе</a><ul><li class="level3"><a href="#use1_10_1">Файлы с кинетическими механизмами</a></li>
<li class="level3"><a href="#use1_10_2">Файл со значением критериев подбора</a></li>
<li class="level3"><a href="#use1_10_3">Файл со значением целевой функции</a></li>
<li class="level3"><a href="#use1_10_4">Файлы со значениями экспериментальной конверсии и рассчитанной по модели конверсии</a></li>
<li class="level3"><a href="#use1_10_5">Файл со значениями целевой функции (всех вычислений)</a></li>
</ul>
</li>
<li class="level2"><a href="#use1_11">Другое</a><ul><li class="level3"><a href="#fromdb">Получение и использование кинетических параметров из базы данных реакций</a></li>
<li class="level3"><a href="#forward_problem">Решение прямых задач</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#use2">Режим анализа параметрической чувствительности и идентифицируемости</a><ul><li class="level2"><a href="#use2_1">Строка запуска</a></li>
<li class="level2"><a href="#use2_2">Синтаксис конфигурационного файла</a><ul><li class="level3"><a href="#use2_2_1">Анализ чувствительности и степеней контроля скорости</a></li>
<li class="level3"><a href="#use2_2_2">Анализ идентифицируемости</a></li>
</ul>
</li>
<li class="level2"><a href="#use2_3">Синтаксис save-файла</a></li>
<li class="level2"><a href="#use2_4">&quot;Массированный&quot; анализ параметрической чувствительности</a></li>
<li class="level2"><a href="#use2_5">Файлы с результатами, создаваемые программой</a></li>
</ul>
</li>
<li class="level1"><a href="#use3">Режим анализа данных</a><ul><li class="level2"><a href="#use3_1">Строка запуска</a></li>
<li class="level2"><a href="#use3_2">Синтаксис конфигурационного файла</a></li>
<li class="level2"><a href="#use3_3">Метод k-средних++ (k-means++)</a><ul><li class="level3"><a href="#use3_3_1">Вычисление наилучшего числа кластеров</a></li>
<li class="level3"><a href="#use3_3_2">Определение наилучшего набора параметров для кластеризации через ГА-оптимизацию суммарного силуэта</a></li>
</ul>
</li>
<li class="level2"><a href="#use3_4">Метод главных компонент (PCA)</a></li>
</ul>
</li>
<li class="level1"><a href="#use4">Режим однократного изменения набора параметров с целью обеспечения термодинамической непротиворечивости</a><ul><li class="level2"><a href="#use4_1">Строка запуска</a></li>
<li class="level2"><a href="#use4_2">Синтаксис конфигурационного файла</a></li>
</ul>
</li>
<li class="level1"><a href="#use5">Режим оптимизации произвольной функции (требует программирования функции)</a><ul><li class="level2"><a href="#use5_1">Строка запуска</a></li>
<li class="level2"><a href="#use5_2">Синтаксис конфигурационного файла</a></li>
<li class="level2"><a href="#use5_3">Примеры</a><ul><li class="level3"><a href="#use5_3_1">Оптимизация функции Растригина</a></li>
<li class="level3"><a href="#use5_3_2">Нахождение оптимальных коэффициентов зависимости порозности слоя от диаметра частиц по экспериментальным данным</a></li>
<li class="level3"><a href="#use5_3_3">Подбор коэффициента активности поверхности и загрузки слоя катализатора (активная поверхность / м3 реактора)</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#use6">Режим тестирования</a><ul><li class="level2"><a href="#use6_1">Строка запуска для отключения генерации псевдослучайных чисел</a></li>
<li class="level2"><a href="#use6_2">Строка запуска тестов (для тестирования кода программы)</a></li>
<li class="level2"><a href="#use6_3">Структура тестов. Создание собственных тестов</a></li>
<li class="level2"><a href="#use6_4">Другие функции тестирования</a><ul><li class="level3"><a href="#use6_4_1">Анализ покрытия кода</a></li>
<li class="level3"><a href="#use6_4_2">Анализ утечек памяти</a></li>
<li class="level3"><a href="#use6_4_3">Непрерывная интеграция</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><dl class="section note"><dt>Заметки</dt><dd><em>mech_optimiz</em> в настоящее время работает только на Linux-системах.</dd></dl>
<h1><a class="anchor" id="use0"></a>
Идея и общая логика программы</h1>
<p>Назначение программы заключается в ассистировании химику-исследователю в изучении механизма каталитического процесса и инженеру при разработке новых и совершенствовании существующих решений, относящихся к проведению каталитических процессов. Такие решения могут касаться: 1) конструкции аппаратов (тип катализатора, геометрия реактора) 2) режима работы (выбор оптимальных параметров для эксплуатации - температуры, концентраций, создание оптимальных температурных профилей).</p>
<p>На данный момент (2015 год) программное обеспечение (ПО) <em>mech_optimiz</em> ограничено процессами:</p><ol type="1">
<li>гетерогенно-каталитическими, без учета реакций в газе/жидкости;</li>
<li>стационарными.</li>
</ol>
<p>В случае реактора неподвижного слоя катализатора учет фазы катализатора отдельно не производится, используется псевдогомогенная модель. Движение катализатора также не может на данный момент учитываться.</p>
<p>Математически рассматриваются однофазные многокомпонентные течения, в том числе - для катализатора неподвижного слоя - модель пористой среды. Фаза катализатора при этом отдельно не рассматривается.</p>
<p>Кинетические параметры могут зависеть только от степеней покрытия поверхности интермедиатами, но, например, не зависят давления.</p>
<p>Начальная идея программы - осуществлять поиск кинетических параметров с помощью параллельного генетического алгоритма. Это реализовано в версии 1. <br />
 Затем, в версии 2, появился учет термодинамических ограничений на значения кинетических параметров. Версия 3 добавила явный и неявный решатели ячеечной модели. Дальнейшее развитие программы в версии 3.2 и 4 связано, преимущественно, с модернизацией этих решателей. <br />
В версии 4 появились несколько ключевых компонентов: анализ идентифицируемости, тесты для некоторых функций и классов, интеграция с базой данных под управлением <em>mongodb</em>, возможность анализа данных и поиска закономерностей в них, "массированный" анализ чувствительности к изменению параметров, наконец, минимизация производства энтропии, минимизация расхождения между изменением энтропии за счет внешнего обмена и протекания внутренних необратимых процессов (что выполняется в стационарном состоянии по закону сохранения). <br />
 Более полную информации о версиях 1-3 вы найдете в документе <a href="version.txt" target="_blank"><b>Версии</b></a>. <br />
 Вся информация об изменениях в 4-ой версии присутствует в истории коммитов с исходным кодом в системе <em>git</em>, что связано с переходом на систему контроля версий <em>git</em>.</p>
<p>Общая логика программы (рассмотрим только подбор кинетических параметров как центральную функциональную возможность программы) может быть проиллюстрирована схемой: </p><div class="image">
<img src="Scheme_mech_optimiz_1.png" alt="Scheme_mech_optimiz_1.png"/>
</div>
<p> <br />
 После задания параметров расчета начинается итерационный подбор параметров кинетического механизма с помощью генетического алгоритма бинарного кодирования. <br />
 Генетический алгоритм содержит множество особей, которые в зависимости от значения целевой функции имеют разную вероятность <br />
а) передать гены потомку <br />
 б) перейти на следующую итерацию.<br />
Чем меньше значения целевой функции, тем эти вероятности выше. <br />
 Хромосомами являются значения кинетических параметров. Используется бинарное кодирование. Отдельный 0/1 <a href="http://www.aiportal.ru/articles/genetic-algorithms/basic-concepts.html" style="color: #FF9933">называется геном, конкретное значение - аллелем, а позиция гена в хромосоме - локусом.</a> <br />
 Особями являются наборы кинетических параметров (мы их называем "механизмы"). В данном случае уровень хромосомы нами отдельно не рассматривался (скажем, как как класс ООП), все хромосомы (кинетические параметры) кодировались в бинарном виде в виде одной склеенной строки (в коде - <code>geneline</code>). <br />
 В результате итерационной процедуры мы получаем наилучший набор кинетических параметров (с некоторой долей притязания на глобальный характер наилучшего решения - что зависит от методики поиска и его длительности). <br />
 Еще раз отметим, что генетический алгоритм использует бинарное кодирование. Каждый кинетический параметр можно кодировать строкой из разного количества нулей и единиц (бит, или генов). Число бит, используемое для кодирования значения одного кинетического параметра, является важной характеристикой, влияющей на точность решения и скорость сходимости к оптимуму. Чем больше количество бит, тем скорость сходимости ниже, но возможно найти более точное решение задачи оптимизации (поиска кинетических параметров) при неизменности границ поиска для каждого параметра. <br />
 Границы поиска по каждому кинетическому параметру задаются пользователем в файле настроек (этот файл еще будем называть конфигурационным файлом). Каждый параметр в ГА бинарного кодирования будет кодироваться дискретно, число уровней <code></code>(levels) кодирования равно \(2^{число\_бит}\). Используется равномерное распределение уровней. Каждый уровень соответствует возможному значению параметра. Значения параметра, не соответствующие целому значению уровня, невозможны. <br />
 Приведем пример. Пусть нижняя граница поиска параметра равна 10, верхняя равна 52. Для трех бит имеем: \(2^3=8\). Тогда, получим, следующие возможные значения уровней и параметра: </p><div class="fragment"><div class="line">Уровень: 0   1   2   3   4   5   6   7</div><div class="line">Параметр:10  16  22  28  34  40  46  52 </div></div><!-- fragment --><p> По существу, в генах ГА осуществляется хранение значений уровней, а не самих параметров. Когда необходимо для определенного параметра поставить в соответствие значение уровня и самого параметра, используется информация о нижней и верхней границе диапазона поиска параметра и о числе бит, используемых для кодирования значения уровня. <br />
 Все генетические операторы применяются к представлению значений уровней в коде Грея.</p>
<p>На каждой итерации подбора параметров вычисляется значение целевой функции, как суммы квадратов отклонений между экспериментальными и расчетными данными (моделирование) по конверсии. Кроме того, перед расчетом целевой функции может осуществляться изменение кинетических параметров отдельных стадий для достижения термодинамической непротиворечивости набора кинетических параметров. Отклонение от математической непротиворечивости в кинетических параметрах есть некоторая уступка, на которую мы вынуждены идти для улучшения качества подбора. Это связано и с недостатками часто используемого в кинетике предположения - независимости энергии активации от температуры, что не является истиной, особенно это сказывается на несогласованности с термодинамикой при построении кинетического механизма для больших температурных интервалов. Это связано и с небольшой погрешностью, заложенной в табулированных значениях термодинамических свойств веществ (в данном случае, газов). Отклонение от непротиворечивости может (и, как настаивает автор, должно!) учитываться в целевой функции при подборе, эта возможность реализована в программе.</p>
<dl class="section note"><dt>Заметки</dt><dd>Для грамотного использования возможностей программы по термодинамическому согласованию кинетических параметров поверхностных реакций, вы должны правильно составить файл с настройками алгоритма согласования (см. <a class="el" href="usage.html#use1_8">Синтаксис файла с параметрами алгоритма обеспечения термодинамической непротиворечивости</a>), а также выбрать базу данных со свойствами веществ, применимую к диапазону температур ваших экспериментальных данных (см. <a class="el" href="usage.html#thermoTemperatures">thermoTemperatures</a>).</dd></dl>
<p>Как правило, мы используем модифицированное уравнение Аррениуса <a class="anchor" id="ModArrh"></a> </p><p class="formulaDsp">
\[ k_r = A_rT^{\beta_{r}}e^{-E_{r}/{RT}} \]
</p>
<p> для записи константы скорости стадии <em>r</em>, поэтому, основные кинетические параметры, используемые нами, это:</p><ul>
<li><code>A</code> - предэкспоненциальный множитель;</li>
<li><code>\(\beta\)</code> - показатель степени при температуре;</li>
<li><code>E</code> - энергия активации стадии. Также возможен учет латеральных взаимодействий (подробнее - см. <a class="el" href="lateral.html">Учет латеральных взаимодействий в <em>mech_optimiz</em> </a>). <br />
 После вычисления значений целевой функции производится отбор особей на скрещивание (кроссинговер). Скрещивание может быть выполнено трех типов: 1) одноточечное (обмен одной из частей хромосомы) 2) многоточечное (обмен каждой второй частью хромосомы) 3) однородное (побитовый обмен в произвольных местах хромосомы) <br />
 Параллелизация вычислений на данный момент происходит:</li>
<li>по данным (каждый поток обрабатывает свои данные - а именно, рассчитывает целевую функцию для своего набора кинетических параметров, который является фенотипом особи). <br />
 Таким образом, реализован достаточно крупнозерновой параллелизм независимых ветвей.</li>
<li>внутриузловой (использована технологии <em>Pthreads</em>). <br />
 Так, <em>mech_optimiz</em> может быть запущена только внутри одного вычислительного узла или на системе с общей памятью (shared memory, SMP-система).</li>
</ul>
<p>Мультистартовый поиск реализуется одновременным или последовательным запуском нескольких копий программы. Число копий программы, запушенных одновременно, ограничено лишь возможностями системы (количество процессов, объем оперативной памяти).</p>
<p>Для работы программы в большинстве режимов (кроме режима тестирования) необходимо подать на ее вход конфигурационный файл. Конфигурационный файл - это набор строк определенной структуры и синтаксиса с информацией для <em>mech_optimiz</em>. <br />
 В файле можно выделить два типа строк: строки, начинающиеся с ключевого слова, и строки, принадлежащие секциям. <a class="anchor" id="general_config_file_structure"></a><br />
 Общая структура файла такова:</p><ul>
<li>строка_с_типом_задачи</li>
<li>строка_параметров_запуска</li>
<li>другие_строки</li>
</ul>
<p><a class="anchor" id="priorityRunParams"></a>Имеется следующий приоритет использования параметров запуска:</p><ol type="1">
<li>Из строки параметров запуска в save-файле;</li>
<li>Из строки параметров запуска конфигурационного файла;</li>
<li>Параметры по умолчанию (заданы в коде программы).</li>
</ol>
<p>Парсер конфигурационного файла разбирает начала файла следующим образом:</p><ol type="1">
<li>Если в первой строке первое слово (до пробела) не является одним из разрешенных типов задачи, то принимается тип задачи RKP. Разрешенные типы задачи:<ul>
<li>RKP - обратная кинетическая задача;</li>
<li>THERMCON - оценка термодинамической непротиворечивости кинетического механизма (немного устаревшее);</li>
<li>THERMCONAE - оптимизация с помощью ГА значений кинетических параметров для обеспечения термодинамической согласованности с заданными термодинамическими функциями (энергия Гиббса, энтропия, энтальпия) для поверхностных частиц;</li>
<li>FUNCTION - оптимизация функции (под каждую функцию необходимо писать отдельный класс с кодом, ее реализующий);</li>
<li>CLUSTERING - кластеризация данных и метод главных компонент.</li>
</ul>
</li>
<li>Если во второй строке файла первым параметром является число, то проверяется длина строки. Если она больше 3, то это строка с параметрами запуска программы для типа RKP. <br />
 Если же параметров 3 и менее, значит мы имеем специфичную строку настроек для оптимизации функции или одного из типов THERM... В этом случае, а также в случае, если первый параметр не являлся числом, мы добавляем фиктивную строку перед данной строкой. Это делается для того, чтобы унифицировать количество предварительных строк для всех типов задач. Так, настройки и входные данные, специфичные для решаемой задачи всегда будут начинаться с третьей строки файла. <div class="fragment"></div><!-- fragment --> <code>При</code> описании синтаксиса файлов мы будем придерживаться ***следующих обозначений***: <b>круглые скобки</b> означают обязательный параметр, где выбирается один вариант из перечисленных в скобках: (y,n) <br />
 <b>Квадратные скобки</b> означают необязательный параметр: [ADDEQUATIONS ...] <br />
 <b>Многоточие вместо строки</b> означает, что далее следует однотипная с предыдущей/ими строка; внутри строки многоточие означает, что информация представлена подробно в отдельном подразделе, и следует обратиться к нему для уточнения синтаксиса.</li>
</ol>
<h1><a class="anchor" id="use1"></a>
Режим подбора кинетических параметров</h1>
<h2><a class="anchor" id="use1_1"></a>
Строка запуска</h2>
<p>./mech_optimiz (конфигурационный_файл,g) [save-file поверхностный_механизм.inp газофазный_механизм.inp термодинамические_свойства.inp]</p><ul>
<li>Итак, для первого аргумента имеется две опции:</li>
<li>либо задается конфигурационный файл (см. <a class="el" href="usage.html#use1_2">Синтаксис конфигурационного файла</a>);</li>
<li>либо выполняется запуск программы в GUI-режиме (опция <em>g</em>).</li>
<li>Второй аргумент - файл с сохраненным решением предыдущего запуска. Важно, чтобы для этого файла и конфигурационного</li>
<li>совпадало число подбираемых кинетических параметров (число параметров, заявленных в секции PARAMETERS конфигурационного файла должно быть равно числу полей минус единица для второй и последующих строк save-файла. <em>Единицу отнять нужно потому, что в save-файл строка помимо фенотипа каждой особи ГА содержит в первом столбце и значение функции приспособленности (в данном случае, равной целевой функции, приспособленность считается лучше, если эта функция <b>ниже</b>)</em></li>
<li>совпадала базовая версия программы (например, 4. 4 версия программы также совместима с save-файлами 2 и 3 версии);</li>
</ul>
<p><b>save-файлы создаются программой на каждой итерации</b> и имеют название вида: </p><div class="fragment"><div class="line">&lt;имя_конфигурационного_файла&gt;-&lt;номер_итерации&gt; </div></div><!-- fragment --><ul>
<li>Третий-пятый аргументы, задают имена файлов (возможно, вместе с путями, относительными, либо абсолютными) для поверхностного механизма, газофазного механизма (который в решаемых mech_optimiz задачах содержит не реакции, а лишь только список газофазных веществ) и файла с термодинамической базой данных в формате CHEMKIN Thermo File. <br />
 По умолчанию, используются следующие имена файлов:</li>
<li>поверхностный механизм: mech.inp</li>
<li>газофазный механизм: gas.inp</li>
<li>термодинамические свойства: thermo.dat Вместо пятого параметра можно указать "+".</li>
<li>+ - искать термодинамические свойства веществ в файлах с газофазным механизмом реакции и поверхностным механизмом (а не в специальном файле, по умолчанию - thermo.dat). <br />
 За эту логику отвечает фрагмент кода (mechTransferParam.cpp): <div class="fragment"><div class="line">filenames.append(mechfile);</div><div class="line">filenames.append(gasfile);</div><div class="line"><span class="keywordflow">if</span> (thermofile==<span class="stringliteral">&quot;+&quot;</span>)</div><div class="line">{</div><div class="line">    imax++;</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">{</div><div class="line">    filenames[0]=thermofile;</div><div class="line">}</div></div><!-- fragment --> Если необходимо указать параметр, пропустив несколько других, введите вместо пропускаемых параметров 'n': Пример: <div class="fragment"><div class="line">./mech_optimiz settings.txt settings.txt-10 n + </div></div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="use1_2"></a>
Синтаксис конфигурационного файла</h2>
<p>Для режима подбора кинетических параметров файл имеет следующую структуру:</p><ul>
<li>[RKP]</li>
<li>[строка_параметров_запуска]</li>
<li>CASE ...</li>
<li>...</li>
<li>CONVERSION_(molar_conc,mole_fr,mass_fr)[_e][_o] [COVRATIO] ...</li>
<li>[ENTROPY PRODUCTION ...номер_реакций...</li>
<li>(y,n) (y,n) (y,n)]</li>
<li>[ADDEQUATIONS (dPdVr dVdVr CONVERSION_REL_ERROR)]</li>
<li>[ADDPARAMS T0 &lt;number&gt;]</li>
<li>[MEAN_COVERAGES]</li>
<li>[MOVE_BOUNDARIES]</li>
<li>[RESPECT_BOUNDARIES]</li>
<li>[DBNAME &lt;name_of_db&gt;]</li>
<li>[WRITEBOUNDARIES]</li>
<li>[USE_SOBOL_NUMBERS &lt;path_and_filename_to_counter&gt;]</li>
<li>[UNITS E KJOULES/MOLE]</li>
<li>[NO_TC]</li>
<li>[CHECK_LIMITATIONS_LEVEL]</li>
<li>PARAMETERS</li>
<li>(номер_реакции (y,n) (y,n) (y,n) число число число [число]</li>
<li>k строк вида <br />
 число число [число] <br />
 где k=сумма значений, начиная со второго, из предыдущей строки, причем y считается за 1, n за 0.</li>
<li>...</li>
<li>ACTIVITY ...</li>
</ul>
<h3><a class="anchor" id="commentaries"></a>
Комментарии в файле настроек</h3>
<p>Любая строка, начинающаяся с восклицательного знака (!), воспринимается как пользовательский комментарий и игнорируется. </p>
<h3><a class="anchor" id="use1_2_1"></a>
Первая строка</h3>
<p><a class="el" href="usage.html#general_config_file_structure">Строка с типом задачи</a> для поиска кинетических параметров должна иметь значение RKP, что расшифровывается как Reverse Kinetic Problem (обратная кинетическая задача). Если строка опущена, по умолчания подразумевается тип задачи RKP. </p>
<h3><a class="anchor" id="use1_2_2"></a>
Cтрока параметров запуска</h3>
<p>В первой строке задаются параметры генетического алгоритма и пути к файлам. Синтаксис некоторых строк (в том числе - этой) будем пояснять на примерах. </p><div class="fragment"><div class="line">0 8 1.0 l5.txt gas.inp mech.inp 16 44 5000 28 32 8 120 </div></div><!-- fragment --><p> В строке параметров запуска указываются:</p><ul>
<li>0 - номер начальной итерации;</li>
<li>8 - число бит в генах;</li>
<li>1.0 - требуемое значение целевой функции, когда останавливается расчет;</li>
<li>l5.txt – относительный путь к файлу с настройками расчета; <br />
 Позволяет вместо файла с настройками, поданного на вход mech_optimiz, можно использовать другой файл, указанный в данном поле. Так, для команды <div class="fragment"><div class="line">./mech_optimiz l200.txt </div></div><!-- fragment --> если файл l200.txt содержит строку параметров "0 8 1.0 l5.txt ...", после чтения типа задачи и строки параметров запуска из l200.txt остальные строки, начиная с третьей, будут считаны из файла настроек l5.txt. Вместо относительного пути можно использовать абсолютный: <a class="anchor" id="Absolute_path"></a><div class="fragment"><div class="line">/home/study/mechanism5/l5.txt </div></div><!-- fragment --> Заметьте, Shell-сокращение '~' для обозначения домашней папки использовать НЕЛЬЗЯ, так как при чтение файла Shell не используется, и у механизма Shell Expansion нет возможности сработать и произвести замену символа '~' на путь. <br />
 Можно поставить '*' вместо указания файла, тогда в качества файла настроек будет использован файл, поданный на вход mech_optimiz.</li>
<li>gas.inp - имя файла с газофазным кинетическим механизмом (нужен для считывания газофазных веществ в механизмах формата CHEMKIN-II, сами механизмы пока игнорируются); <a class="el" href="usage.html#Absolute_path">Аналогично конфигурационному файлу</a>, можно производить указание абсолютного пути для файла. Можно поставить '*' вместо указания файла, тогда gas.inp использоваться не будет.</li>
<li>mech.inp - имя файла с поверхностным кинетическим механизмом (surface kinetic mechanism) (в формате CHEMKIN-II); <a class="el" href="usage.html#Absolute_path">Аналогично конфигурационному файлу</a>, можно производить указание абсолютного пути для файла. <br />
 Только первые 6 параметров являются обязательными в строке параметров запуска. Последующие параметры могут быть заданы или все разом опущены:</li>
<li>16 - число потомков, создаваемых на каждой итерации генетического алгоритма;</li>
<li>44 - максимальное число потоков (Pthreads) - особей ГА, создаваемое программой. Если число рассчитываемых хромосом превысит число потоков на какой-либо итерации, будет произведено разделение популяции на части по числу потоков;</li>
<li>5000 - максимальное число итераций генетического алгоритма (ГА);</li>
<li>28 - число хромосом в популяции генетического алгоритма;</li>
<li>32 - вероятность мутации бита при выполнении операции кроссинговера ГА, %;</li>
<li>8 - вероятность инверсии бита при выполнении операции кроссинговера ГА, %;</li>
<li>120 - число секунд на расчет одной экспериментальной точки (dataPoint).</li>
</ul>
<p>В случае некорректного задания параметров (отрицательные значения), будут использованы следующие значения по умолчанию:</p><ul>
<li>число бит в генах: 8;</li>
<li>требуемое значение целевой функции: 0.01;</li>
<li>имя файла с газофазным кинетическим механизмом: gas.inp;</li>
<li>имя файла с поверхностным кинетическим механизмом: mech.inp;</li>
<li>число потомков, создаваемых на каждой итерации: 52;</li>
<li>максимальное число потоков (особей ГА): 68;</li>
<li>максимальное число итераций генетического алгоритма: 1000;</li>
<li>вероятность мутации бита: 17;</li>
<li>вероятность инверсии бита: 8;</li>
<li>число хромосом в популяции ГА: 16;</li>
<li>число секунд на расчет одной экспериментальной точки: 420.</li>
</ul>
<h3><a class="anchor" id="use1_2_3"></a>
Строка CASE</h3>
<p>Это строка относится к отдельной серии экспериментов, набору опытов, производимых на одной установке при ряде рабочих условий. Под последними в данном случае понимается только изменение температуры. Все параметры, задаваемые в данной строке, полагаются не зависящими от температуры для данного опыта. Например, в строке CASE задаются мольные доли веществ, которые не изменяются от опыта к опыту в условиях одной серии экспериментов.</p>
<p>Разберем структуру данной записи на примере: </p><div class="fragment"><div class="line">CASE CSTRCASCADE 921 Honeycomb 1D 2 CO O2 CO2 0.01 0.02 0.00 He 0.012 0.008 2e-08 Pt(S) 0.7 O(S) 0.3 3.156e-07 1.07879E+06 0.301 30 70 120 </div></div><!-- fragment --><p>Структура строки:</p><ul>
<li>CASE - ключевое слово. Объявляется новый набор экспериментальных данных по конверсии (внутри него одинаковые параметры реактора и исходной смеси, т.е., так называемого потока питания (feed stream));</li>
<li>CSTRCASCADE - тип задачи. Для реактора с неподвижным слоем катализатора можно выбрать ячеечную модель (CSTRCASCADE).</li>
<li>&lt;ЧИСЛО&gt; - уникальный номер серии экспериментов (выставляется пользователем по своему усмотрению, должен быть целым положительным числом (не более 2 млрд). <br />
 <em>В примере</em>: набор данных № 921.</li>
<li>Honeycomb - тип расчетной области - канальная модель.</li>
<li>1D - размерность задачи.</li>
<li>&lt;ЧИСЛО&gt; - число веществ-загрязнителей. Все вещества в <em>mech_optimiz</em> подразделяются на три типа:</li>
</ul>
<ol type="1">
<li>Вещества, по которым будет сравниваться конверсия с экспериментальными данными. Конверсия этих веществ рассчитывается и влияет на т.н. "критерий по конверсии", то есть значение суммы квадратов отклонений по конверсии данных моделирования от данных экспериментов.</li>
<li>Другие активные вещества. Вещества, число молекул которых изменяется, но для которых конверсия не рассчитывается. <br />
 Вещества типов 1 и 2 вместе составляют "активные вещества".</li>
<li>Инерты. Эти вещества не вступают в реакции и не являются продуктами реакции, и общее содержание (число молей, молекул) вещества по длине реактора остается постоянным. <br />
 <em>В примере</em>: 2 вещества. <a class="anchor" id="mainSubstances"></a></li>
</ol>
<ul>
<li>&lt;ВЕЩЕСТВО-1&gt; [&lt;ВЕЩЕСТВО-2&gt; ...] - список веществ, по которым будет сравниваться конверсия с экспериментальными данными (<b>основные вещества</b>) <br />
 <em>В примере</em>: CO и O2.</li>
<li>&lt;ВЕЩЕСТВО-1&gt; [&lt;ВЕЩЕСТВО-2&gt; ...] - список других активных веществ <br />
 <em>В примере</em>: CO2.</li>
<li>&lt;ЧИСЛО-1&gt; [&lt;ЧИСЛО-2&gt; ...] - мольные доли для всех активных веществ (в т.ч. - основных) в порядке их указания в списках веществ ранее в строке. <br />
 <em>В примере</em>: 0.01 ( \(x_{CO}\)), 0.02 ( \(x_{O2}\)), 0.00 ( \(x_{CO2}\)).</li>
<li>&lt;ВЕЩЕСТВО&gt; - инерт (может быть только один, иначе программа сообщит о неверном задании инертов, и, выдав в лог ошибку, завершит выполнение). <br />
 <em>В примере</em>: He - это инерт (inert) или газ-носитель (carrier-gas) <br />
 Заметим, что мольная доля инерта не задается, а вычисляется как единица минус сумма мольных долей всех других веществ, которые были заданы ранее в строке.</li>
<li>&lt;ЧИСЛО&gt; - длина каталитической секции, м (<em>В примере</em>, 0.012);</li>
<li>&lt;ЧИСЛО&gt; - диаметр трубки (внутренний), м (<em>В примере</em>, 0.008);</li>
<li>&lt;ЧИСЛО&gt; - плотность реакционных центров в \(кмоль/м^2\) (<em>В примере</em>, 2e-08);</li>
<li>&lt;ВЕЩЕСТВО-1&gt; &lt;ЧИСЛО-1&gt; [&lt;ВЕЩЕСТВО-2&gt; &lt;ЧИСЛО-2&gt; ...]</li>
<li>начальное заполнение поверхности адсорбатами - название и доля покрытия поверхности. В сумме должны давать строго единицу. <br />
 <em>В примере: </em>Pt(S) 0.7 O(S) 0.3;</li>
<li>&lt;ЧИСЛО&gt; - массовый расход газа (кг/с) (<em>В примере</em>, 3.156e-07);</li>
<li>&lt;ЧИСЛО&gt; - коэффициент, учитывающий величину активной поверхности на \(м^3\) реактора ( \(м^2/м^3\)) (<em>В примере</em>, 1.07879E+06);</li>
<li>0.301 - порозность - доля пустот в каталитическом слое, через которые протекает газ (безразмерная) (<em>В примере</em>, 0.301);</li>
<li>&lt;ЧИСЛО&gt; - максимальное число итераций по газофазным веществам на 1 реактор (<em>В примере</em>, 30);</li>
<li>&lt;ЧИСЛО&gt; - число реакторов ИС (идеального смешения) в каскаде (<em>В примере</em>, 70);</li>
<li>&lt;ЧИСЛО&gt; - средний диаметр частиц, мкм (нужен, если учитывается изменение давления по слою) (<em>В примере</em>, 120);</li>
</ul>
<p>Кроме того, строка может включать</p><ul>
<li>А) 5 дополнительных параметров - вещественных чисел, относящихся к оценке диффузионного лимитирования. При этом уровень оценки (разный уровень = различный режим работы программы) должен быть больше или равен 1 (см. <a class="el" href="usage.html#use1_2_15">Строка CHECK_LIMITATIONS_LEVEL</a>). <br />
 Пример: <div class="fragment"><div class="line">1500.0 1.0e-08 145000.0 1.0 290.0 </div></div><!-- fragment --></li>
<li>[&lt;ЧИСЛО&gt;] - насыпная плотность катализатора (т.е., с учетом порозности каталитического слоя) [кг/м3 реактора]. <em>В примере: </em> 1500.0;</li>
<li>[&lt;ЧИСЛО&gt;] - средний диаметр поры [м] (для расчета коэффициента кнудсеновской диффузии). <em>В примере: </em> 1.0e-08;</li>
<li>[&lt;ЧИСЛО&gt;] - кажущаяся энергия активации реакции (для степенной кинетики n-го порядка) [Дж/кмоль]. <em>В примере: </em> 145000.0;</li>
<li>[&lt;ЧИСЛО&gt;] - порядок реакции n для степенной кинетики <em>В примере: </em> 1.0;</li>
<li>[&lt;ЧИСЛО&gt;] - тепловой эффект реакции [кДж/моль]. <em>В примере: </em> 290.0.</li>
</ul>
<p><b>ИЛИ</b></p><ul>
<li>Б) 7 дополнительных параметров, относящихся к учету теплообмена ("труба в трубе". прямоточный теплообменник) и тепловыделения (за счет теплоты реакции) в ходе реакции <br />
 Пример: <div class="fragment"><div class="line">0.0005 19.3 0.01 3.1e-05 703.15 1e-04 1e-04 </div></div><!-- fragment --></li>
<li>[&lt;ЧИСЛО&gt;] - толщина стенки реактора [м]. <em>В примере: </em> Толщина стенки, отделяющей внутреннее пространство реактора от окружения (возможно, с теплоносителем) составляет 0.5 мм, или 0.0005 м: 0.0005;</li>
<li>[&lt;ЧИСЛО&gt;] - коэффициент теплопроводности стенки [Вт/(м К)]. <em>В примере: </em> 19.3;</li>
<li>[&lt;ЧИСЛО&gt;] - диаметр внешней трубы при теплообмене по схеме "труба в трубе" [м]. <em>В примере: </em> 0.01;</li>
<li>[&lt;ЧИСЛО&gt;] - массовый расход теплоносителя/хладагента во внешней трубе для теплообмена "труба в трубе" <em>В примере: </em> 3.1e-05;</li>
<li>[&lt;ЧИСЛО&gt;] - начальная температура теплоносителя [К]. <b>Поскольку рассматривается только прямоток реагирующей смеси и теплоносителя, температура Tc задается с той же стороны реактора, что и T реагирующей смеси.</b> <em>В примере: </em> 290.0.</li>
<li>[&lt;ЧИСЛО&gt;] - точность [К] установления значений по температуре стенки (при расчете внутреннего цикла алгоритма теплообмена). <em>В примере: </em> 1e-04.</li>
<li>[&lt;ЧИСЛО&gt;] - точность [К] установления значений по температуре в реакторе (при расчете внешнего цикла алгоритма теплообмена). <em>В примере: </em> 1e-04.</li>
</ul>
<h3><a class="anchor" id="use1_2_4"></a>
Строка CONVERSION</h3>
<p>Далее в файле объявлены температурные точки с конверсией, то есть значения конверсии при различных температурах из эксперимента (пример): </p><div class="fragment"><div class="line">CONVERSION_molar_conc_e_o 921 473.15 40.75 16.53 </div></div><!-- fragment --><ul>
<li>CONVERSION ключевое слово; Обязательно должен быть указан один из трех модификаторов:</li>
</ul>
<ol type="1">
<li><code>molar_conc</code> - конверсия рассчитана на основе мольной концентрации (как в примере)</li>
<li><code>mole_fr</code> - конверсия рассчитана на основе мольной доли</li>
<li><code>mass_fr</code> - конверсия рассчитана на основе массовой доли (это определение истинной конверсии, поскольку массовая доля и концентрация не зависят от расширения/сжатия газа при изменении внешних условий или протекании реакции с изменением числа молей. Поэтому, во избежание путаницы и прозрачности результатов для лиц, не использующих программу, рекомендуется рассчитывать экспериментальную конверсию таким образом, и использовать модификатор mass_fr в программе).</li>
</ol>
<ul>
<li><code>_e</code> и <code>_o</code> - это дополнительные модификаторы, которые показывают, что нужно проводить для данной температурной точки расчет производства энтропии в реакторе. <br />
 При этом, учитывать значение производства энтропии для данной точки в критерии по производству энтропии <code></code>(_e) и выводить значения в файл <code></code>(_o).</li>
<li>921 - номер <code>CASE</code> (должен соответствовать описанному выше <code>CASE</code>, иначе точка будет проигнорирована при дальнейшем моделировании);</li>
<li>473.15 - температура (K);</li>
<li>40.75 16.53 - конверсия объявленных в секции <code>CASE</code> веществ, по которым будет сравниваться конверсия (в данном случае это - <em>CO</em> и \(O_2\)); <a class="anchor" id="covratio"></a></li>
<li>Также в строке может присутствовать модификатор <code>COVRATIO</code>, который задает экспериментальные данные о покрытии поверхности группами адсорбатов. <br />
 В этом случае сумма квадратов отклонений данных моделирования по значениям покрытия поверхности группами адсорбатов от приведенных данных эксперимента будет включена в критерий по конверсии. Пример: <div class="fragment"><div class="line">CONVERSION 14 473.15 COVRATIO OCu(s) OCuCO(s) OCuCO2(s) : OCuO(s) OCuOCO(s) CuCO3(s) 0.435 100 </div></div><!-- fragment --> означает, что экспериментальное отношение суммарной доли частиц <em>OCu(s)</em>, <em>OCuCO(s)</em>, <em>OCuCO2(s)</em> к суммарной доли частиц <em>OCuO(s)</em>, <em>OCuOCO(s)</em>, <em>CuCO3(s)</em> на катализаторе равно 0.435.</li>
</ul>
<h3><a class="anchor" id="use1_2_5"></a>
Строка ENTROPY PRODUCTION</h3>
<p>Используется для указания, какие обратимые реакции мы используем при расчете критерия по производству энтропии (т.е., указав часть реакций, можно производить минимизацию производства энтропии по данным реакциям). <br />
 Пример: </p><div class="fragment"><div class="line">ENTROPY_PRODUCTION 1 3 5 19</div></div><!-- fragment --><p> Данная строка указывает программе рассчитывать производство энтропии для обратимых реакций, которые в качестве прямой или обратной стадии имеют 1, 3, 5 или 19 стадию. <br />
 Следует указывать одну любую стадию из пары стадий, входящих в обратимую реакцию. <br />
 Следующая строка определяет критерии, которые мы используем при подборе кинетических параметров (в общей сумме), <em>y</em> - использовать критерий, <em>n</em> - не использовать: </p><div class="fragment"><div class="line">(y,n) (y,n) (y,n) </div></div><!-- fragment --><p> В этой записи первый критерий - есть критерий по конверсии, второй - по термодинамической непротиворечивости, третий - по производству энтропии. </p><dl class="section note"><dt>Заметки</dt><dd>Если <b>строка ENTROPY_PRODUCTION</b> и, соответственно, строка указания критериев <b>отсутствует</b>, то, <b>по умолчанию, используется только критерий по конверсии</b>. <br />
 Если критерий термодинамической непротиворечивости не включается в суммарный критерий (вторая буква в строке - <em>n</em>, или строка не указана), то не производится модификация кинетических параметров обратных стадий, но оценка термодинамической непротиворечивости (поиск наилучших значений коэффициентов термодинамических полиномов, обеспечивающих <a href="doc_tc.html">минимальное рассогласование по изменению энтропии и энтальпии реакций / энергии Гиббса реакций</a>, а также расчет критерия термодинамической непротиворечивости) все равно выполняется. <br />
 Значения критерия записываются в файл <em>criteria.txt</em> (как и в других случаях, только для итераций, когда происходит улучшение основных критериев, учитываемых в подборе), а величина невязки по каждой реакции и суммарной невязки (по стандартному изменению энтропии/энтальпии реакции или энергии Гиббса реакции - опять же, в зависимости от типа процедуры <a href="doc_tc.html">TC</a>. указывается в файле с <a class="el" href="usage.html#use1_10_1">кинетическим механизмом</a>.</dd></dl>
<h3><a class="anchor" id="use1_2_6"></a>
Строка ADDEQUATIONS</h3>
<p>Данная строка подключает дополнительные уравнения к математической модели решателя CSTRCASCADE.</p><ul>
<li>dPdVr - учитывать изменение давления за счет сопротивления пористой среды. <br />
 Для расчета гидравлического сопротивления используется уравнения Эргана: <p class="formulaDsp">
\[ dP/dx = a\mu u_{sup}+b\rho u_{sup}^2 \]
</p>
 Если указана эта опция, в рабочей директории должен присутствовать файл формата CHEMKIN Transport Properties Database "tran.dat", содержащий транспортные свойства (свойства, относящиеся к переносу) веществ. Это, в том числе, параметры потенциала Леннард-Джонса (12-6): <p class="formulaDsp">
\[ u(r) = 4\epsilon[(\frac{\sigma}{r})^{12}-(\frac{\sigma}{r})^6] \]
</p>
 где \(\sigma\) - характеристическая длина, на которой потенциал становится равным нулю, \(\epsilon\) - глубина потенциальной ямы. Расчет свойств веществ (вязкость) на основе энергетических параметров производится в объекте Cantera::Transport, инициализированном с типом "Mix".</li>
<li>dVdVr - учитывать изменение объема (числа молей) смеси в ходе химической реакции / при изменении температуры (ветвь кода heat_exchange_implicit)</li>
<li>CONVERSION_REL_ERROR - если указан этот параметр, то влкда точки в критерий по конверсии рассчитывается не на основе абсолютного отклонения, а на основе относительного отклонения. <br />
 Эту опцию полезно указывать для всех/части точек, если нужна одинаковая относительная точность подбора для различных экспериментальных точек. Например, в случае эксперимента в дифференциальном реакторе (конверсия менее 10%), только использование этой опции позволяет произвести хороший (модель адекватна эксперименту) подбор.</li>
</ul>
<h3><a class="anchor" id="use1_2_7"></a>
Строка ADDPARAMS</h3>
<dl class="section note"><dt>Заметки</dt><dd>Этот раздел писался примерно через год после имплементации указанных уравнений без опоры на код, поэтому, формулы нуждаются в проверке. Могут быть особенности.</dd></dl>
<p>В этой строке могут быть указаны следующие параметры:</p><ul>
<li>T0 &lt;ЧИСЛО&gt; - указание, что для кинетического механизма используется опорная температура \(T_{0}\), и значение этой температуры. <br />
Этот параметр играет роль только, если в каких-либо стадиях использован параметр \(\beta\), отличный от нуля. <br />
Конвертация предэкспоненты [1/c], записанной в файле с кинетическим механизмом, во внутреннее представление <em>mech_optimiz</em>, выполняется следующим образом: <p class="formulaDsp">
\[ A_{r,\ internal\ (without\ T{_0})} = A_{r,\ from\ mechanism} / T{_0}^{\beta{ _r}} \]
</p>
 Если предэкспонента имела более сложные единицы, чем 1/с, то также, как обычно, выполняется конвертация единиц в 1/с. <br />
Внутреннее представление <em>mech_optimiz</em> удобно для использования <a class="el" href="usage.html#ModArrh">модифицированного уравнения Аррениуса</a>, доступного в <em>CHEMKIN</em> и <em>Cantera</em>.</li>
</ul>
<h3><a class="anchor" id="use1_2_8"></a>
Строки MEAN_COVERAGES, DBNAME, WRITEBOUNDARIES</h3>
<ul>
<li>MEAN_COVERAGES - позволяет задать средние значения долей покрытия для выбранных адсорбатов. Опция полезна, когда в базе данных содержатся записи о кинетических параметрах стадий с указанием их зависимости от доли покрытия поверхности (влияние латеральных взаимодействий). Так как указанные значения могут быть довольно велики, пренебрегать ими нельзя. Поэтому, если пользователь ищет эффективные кинетические параметры (без отражения влияния латеральных взаимодействий на параметры в зависимости от покрытия поверхности), необходимо брать из базы данных значения параметров при тех долях покрытия поверхности, которые, в среднем, наличествуют в реакторе. Эти доли и указываются в строке MEAN_COVERAGES. <br />
 Если такая строка отсутствует, или в ней не указаны доли покрытия для частиц, от которых зависят кинетические параметры, то записи базы данных, содержащие значения параметров в зависимости от заполнения поверхности, будут проигнорированы. Пример:<div class="fragment"><div class="line">MEAN_COVERAGES CO(s) 0.8 NO(s) 0.0 </div></div><!-- fragment --> позволяет программе использовать (поимо записей с эффективными параметрами) записи из базы данных, где кинетические параметры приведены в зависимости от заполнения поверхности CO(s) или NO(s). Как видно из представленных численных значений, поверхность предполагается почти полностью покрытой CO(s), и чистой от NO(s). Это и будет учтено при поучении значений из базы данных кинетических параметров (см. .</li>
<li>WRITEBOUNDARIES - указывает, что найденные границы надо не использовать для подбора, а записать в новый конфигурационный файл и выйти. Новый конфигурационный файл имеет вид: <em>старый_конфигурационный_файлFROMDB.расширение_старого_конфигурационного</em> файла</li>
<li>DBNAME &lt;name_of_db&gt; - используется для задания имени файла с коллекцией реакций. <br />
 Коллекция - тематически организованная совокупность данных. Для того чтобы хранить данные по различным реакциям/процессам, не очищая каждый раз БД, для каждой реакции/процесса предлагается использовать свою коллекцию, и изменять только имя используемой коллекции. По умолчанию - mreactions.</li>
</ul>
<h3><a class="anchor" id="use1_2_9"></a>
Строка MOVE_BOUNDARIES</h3>
<p>Задает использование алгоритма движения (изменения) границ. (см. optimizCore::changeBoundaries) <br />
 По умолчанию, механизм отключен. На данный момент передвигать возможно только границы поиска параметров <em>A</em>, \(\beta\), <em>E</em>. <br />
 Алгоритм работает следующим образом:</p><ul>
<li>в случае, если средняя приспособленность популяции ГА за последние 20 итераций изменилась менее, чем на 5%, то центрировать границы относительно значений наилучшей особи;</li>
<li>центрирование выполняется с сохранением ширины границ, кроме случая, когда новая нижняя граница для параметра <em>A</em> или <em>E</em> оказывается меньше 0. В последнем случае, новая граница принимается равной 0.</li>
</ul>
<h3><a class="anchor" id="use1_2_10"></a>
Строка RESPECT_BOUNDARIES</h3>
<p>Данная строка заставляет алгоритм <code>dHdS</code> модификации кинетических параметров обратных стадий обратимых реакций соблюдать границы, объявленные для поиска параметров в файле настроек. Также см.: <a class="el" href="thermcons.html#TCAlgReverse">Модификация кинетических параметров обратных стадий</a></p>
<h3><a class="anchor" id="use1_2_11"></a>
Строка USE_SOBOL_NUMBERS</h3>
<p>Позволяет указать, что надо использовать не генератор псевдослучайных чисел <code>rand_r()</code>, а последовательности Соболя (равномерно распределенные числа). Генотипы новых особей при применении стратегии обновления популяции формируются за счет случайных чисел-генов. Многомерная последовательность Соболя (размерность совпадает с размерностью генотипа - числом генов) позволяет генерировать особи, покрывая пространство параметрического поиска точками наиболее равномерно.</p><ul>
<li>USE_SOBOL_NUMBERS &lt;path_and_filename_to_counter&gt; - вторым параметром указывается путь и имя файла со счетчиком (в котором записан в двоичном формате номер текущего числа из последовательности Соболя). Доступ к файлу из <em>mech_optimiz</em> осуществляется с помощью <code>flock()</code>, чтобы предотвратить условие гонки потоков. <a href="http://man7.org/linux/man-pages/man2/flock.2.html">Работает корректно на NFS-системах с версией ядра Linux &gt;= 2.6.12 </a></li>
</ul>
<h3><a class="anchor" id="use1_2_12"></a>
Строка UNITS</h3>
<p>Позволяет задавать единицы по умолчанию для некоторых величин.</p><ul>
<li>UNITS E (KJOULES/MOLE, JOULES/KMOLE) позволяет задать единицы энергии активации, в которых она приводится в конфигурационном файле и save-файлах. <br />
 Значение по умолчанию - KJOULES/MOLE.</li>
</ul>
<h3><a class="anchor" id="use1_2_13"></a>
Строка SELECTIVITY_ANALYSIS</h3>
<p>Синтаксис строки: </p><div class="fragment"><div class="line">SELECTIVITY_ANALYSIS ЧИСЛО ВЕЩЕСТВО-А ВЕЩЕСТВО-Б </div></div><!-- fragment --><p> ЧИСЛО определяет стехиометрическое отношение вещества Б к веществу А в рассматриваемом химическом процессе.</p>
<p>То есть, если из 2 молекул (2 молей) вещества А мы получаем 1 молекулу (1 моль) вещества Б, то ЧИСЛО (лямбда-отношение) равно 1/2=0.5.</p>
<p>Пример: </p><div class="fragment"><div class="line">SELECTIVITY_ANALYSIS 0.5 NO N2O </div></div><!-- fragment --><h3><a class="anchor" id="use1_2_14"></a>
Строка NO_TC</h3>
<p>Указанная строка отключает проверку термодинамической согласованности кинетических параметров, что может быть использовано в некоторых случаях для ускорения расчетов. <br />
 При этом не важно, указано ли в строке ENTROPY_PRODUCTION включать критерий термодинамической непротиворечивости в целевую функцию (y), или нет (n). Критерий не будет рассчитываться и учитываться при вычислении значения целевой функции.</p>
<h3><a class="anchor" id="use1_2_15"></a>
Строка CHECK_LIMITATIONS_LEVEL</h3>
<p>Данная строка дает команду программе исследовать наличие диффузионных ограничений в реакторе неподвижного каталитического слоя.</p>
<p>Уровень 0 отключает проверки. Уровни 1-2 включают их, при этом любые предупреждения связанные с диффузионным лимитированием (см. cstrsolver::checkMassAndHeatTransferLimitations()) будут отображаться.</p>
<p>Уровень 2 также изменяет скорости реакций по компонентам газовой смеси, домножая их на итоговый фактор эффективности (внешнедиффузионные + внутридиффузионные ограничения). Факторы эффективности рассчитываются для каждого вещества, конверсию которого задано сравнивать с экспериментальными значениями при подборе кинетических параметров, если только их начальная концентрация (в исходной смеси) не равна 0 (т.е., если они являются реагентами).</p>
<h3><a class="anchor" id="use1_2_par"></a>
Строка PARAMETERS</h3>
<dl class="section note"><dt>Заметки</dt><dd>Секция PARAMETERS должна следовать после объявления всех экспериментальных установок (CASE) и температурных точек (CONVERSION). Общий вид записи элементов секции:<ul>
<li>(номер_реакции (y,n) (y,n) (y,n) число число число [число]</li>
<li>... Номер реакции должен соответствовать номеру реакци в файле с поверхностным кинетическим механизмом.</li>
</ul>
</dd></dl>
<p>Три опции y/n означают, будет ли подбираться предэкспоненциальный множитель <em>A</em>, степень при температуре \(\beta\) и энергия активация <em>E</em>, соответственно. Каждый y обязывает написать ниже строку, в которой указать первым параметром нижнюю границу поиска параметра, вторым параметром - верхнюю границу поиска. Третьим (необязательным) параметром может быть число бит, используемое для кодирования значений параметра - так, можно задать большее число бит для более чувствительных параметров, где точность нахождения оптимального значения требуется высокая. Пример: </p><div class="fragment"><div class="line">1 y n y 0 0 0</div><div class="line">1e+13 1e+14</div><div class="line">105 144 10 </div></div><!-- fragment --><p> Энергия активации в данном случае будет искаться в пределах 105-144 ед. (по умолчанию - кДж/моль) с использованием 10 бит для кодирования.</p>
<p>Три числа далее указывают число модификаторов \(\eta\), \(\mu\), \(\epsilon\) для учета влияния степени покрытия поверхности тем или иным адсорбатом на кинетику реакции (учет латеральных взаимодействий, см. <a class="el" href="citelist.html#CITEREF_keechemkin">[3]</a>). Каждое значение <em>k</em>, отличное от нуля, для этих чисел влечет за собой необходимость указания строк <em>k</em> описания влияния адсорбатов на кинетические параметры. Параметры \(\eta\), \(\mu\) изменяют предэкспоненциальный множитель, а параметр \(\epsilon\) - энергию активации реакции в зависимости от покрытия поверхности.</p>
<p>Пример: </p><div class="fragment"><div class="line">1 n n y 0 1 1</div><div class="line">105 144</div><div class="line">CO(S) -0.5 0.5</div><div class="line">O(S) -30 -10 </div></div><!-- fragment --><p> В данном случае параметр \(\mu\) учитывает заполнение поверхности CO(S) и изменяется от -0.5 до 0.5, а параметр \(\epsilon\) изменяется от -30 до -10, вводя учет влияния заполнения поверхности адсорбатом O(S). <br />
 Как видно, эти три параметра допускают отрицательные значения, и пределы поиска задаются в порядке возрастания значений.</p>
<p>Для каждой реакции может быть еще задан и седьмой, опциональный параметр, где указывается число подбираемых частных порядков реакции, не равных стехиометрическим коэффициентам. Это дает возможность подбирать кинетические параметры брутто-реакций, а не элементарных стадий. </p><div class="fragment"><div class="line">1 n n y 0 0 0 1</div><div class="line">105 144</div><div class="line">CO(S) 1.0 2.0 </div></div><!-- fragment --><p> Этот пример показывает поиск частного порядка реакции по веществу CO(S) в границах от 1.0 до 2.0. <br />
 Напомним, что изменение порядка реакции в кинетическом механизме (по умолчанию, частные порядки по реагентам равны стехиометрическим коэффициентам, по продуктам - равны нулю) производится с помощью ключевого слова /ORD .../ в строке после записи реакции. Подробнее, см. <a class="el" href="citelist.html#CITEREF_keechemkin">[3]</a>.</p>
<p>Вместо каждой строки с указанием диапазона поиска параметра может быть указано ключевое слово FROM_DATABASE (кроме строки для поиска частного порядка реакции). Тогда значения границ будут определены с использованием базы данных реакций (см. <a class="el" href="usage.html#fromdb">Получение и использование кинетических параметров из базы данных реакций</a>).</p>
<h3><a class="anchor" id="use1_2_act"></a>
Строка ACTIVITY</h3>
<p>Позволяет выполнять подбор начального распределения адсорбатов на катализаторе, а через это - каталитической активности. Адсорбаты могут относиться к типам активных центров с разной кинетикой (в т.ч. - неактивным), поэтому, мы можем менять активность катализатора, просто меняя начальное заполнение поверхности. При этом в кинетическом механизме в каждой реакции должен выполняться закон сохранения числа активных центров каждого типа.</p>
<p>Например, пусть на катализаторе есть два типа активных центров: платиновые и родиевые. Начальное заполнение центров каждого типа представлено частицами Pt(S) и Rh(S).</p>
<div class="fragment"><div class="line">...</div><div class="line">CASE CSTRCASCADE 1201 Honeycomb 1D 1 CO O2 CO2 0.077 0.15 0.00 N2 0.06 0.019078 1.2e-08 Pt(S) 0.12 Rh(S) 0.88 6.386E-07 4.081E+06 0.306 30 30 120</div><div class="line">...</div><div class="line">ACTIVITY 1201 1 0 1 1 1</div><div class="line">0.1 0.5 10</div></div><!-- fragment --><p> Итак, ACTIVITY - это строка с указанием типов активных центров.</p>
<p>В строке после ключевого слова ACTIVITY указываются:</p><ul>
<li>номер набора экспериментов (установки) CASE <em>(1201)</em></li>
<li>число строк с границами поиска доли заполнения поверхности <em>(1)</em></li>
<li>номер (id) типа активного центра/активной части (для каждого центра задается одна активная частица, та, что в строке CASE). Доли этих частиц на поверхности в начальный момент времени будут подбираться. <em>(0)</em></li>
<li>число мест, занимаемой частицей на поверхности (в примере - <em>(1)</em>). Например, димеры занимают два активных центра, что нужно учитывать при расчете доли заполнения поверхности. <br />
 Далее последние два столбца повторяются для каждого активного центра.</li>
</ul>
<p>В следующих строках указываются границами поиска доли заполнения поверхности (первые два параметра), а так же, как и при поиске кинетических параметров, третьим параметром можно указывать количество бит для кодирования признака <em>(10)</em></p>
<p>Вы видите в примере два типа активных центров:</p><ul>
<li>id=0 (пусть это будут активные центры платины), частица занимает одно место на поверхности (эта частица в строке CASE с совпадающим номером - 1201. Эта частица является первой в части строки, отвечающей за начальное заполнение поверхности: Pt(S) )</li>
<li>id=1, частица занимает одно место на поверхности (эта частица также задается в строке CASE 1201: Rh(S)).</li>
</ul>
<p>Число строк с границами диапазона поиска может не совпадать с числом типов активных центров, как здесь: <br />
 <em>ACTIVITY</em> <em>1201</em> <b>1</b> - задается доля активных центров только одного типа. <br />
 Это тип id=0 (поскольку он записан первым в строке с указанием типов активных центров). <br />
 Поиск доли активных центров данного типа ведется в границах: </p><div class="fragment"><div class="line">0.1 0.5 </div></div><!-- fragment --><p> Оставшаяся часть поверхности (доля, 1.0-sum_w_sites) будет распределена между всеми остальными (числом unspec_sites_count) типами активных центров равномерно (это производится в individual.cpp): </p><div class="fragment"><div class="line">v1[j].second.second=(1.0-sum_w_sites)/unspec_sites_count; </div></div><!-- fragment --><p>Итак, в вышерассмотренном примере при доле активных центров первого типа (платины), равной 0.3, доля активных центров второго типа (родия) будет вычислена автоматически как (1-0.3)/1=0.7. При этом, начальное заполнение поверхности будет определено как: Pt(S):0.3, Rh(S):0.7.</p>
<dl class="section note"><dt>Заметки</dt><dd>В коде individual.cpp реализована возможность пересчет числа активных центров для учета того, что если активный центр некоторого типа всегда состоит из нескольких атомов (двух - димерный), то необходимо уменьшить число активных центров (начальное предположение - число активных центров равно числу атомов некоторого вещества/ ряда веществ - например, платины и родия). К сожалению, эта возможность еще <b>не тестирована</b>! <div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;v1.size(); j++)</div><div class="line">{</div><div class="line">    v1[j].second.second=v1[j].second.second*rc_tot/v1[j].second.first;</div><div class="line">    sum_w+=v1[j].second.second;</div><div class="line">}</div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;v1.size(); j++)</div><div class="line">    v1[j].second.second/=sum_w;<span class="comment">//new site fractions, parts of new rc_density (dimer accounting e.g)</span></div><div class="line"><span class="comment">//my_pool-&gt;datapoints[n]-&gt;setRCDensity(sum_w); //do not modify, see comment below</span></div><div class="line">copy_datapoint-&gt;setRCDensity(sum_v);</div></div><!-- fragment --></dd></dl>
<h2><a class="anchor" id="use1_3"></a>
Синтаксис save-файла</h2>
<p>Синтаксис save-файла следующий. Первая строка является строкой параметров запуска, которые являются приоритетными над указанными в других файлах (см. <a class="el" href="usage.html#priorityRunParams">ссылку</a>)</p>
<p>Далее следуют строки, содержащие <em>k+1</em> число, где <em>k</em> - число кодируемых параметров (генов ГА). Каждая строка, начиная со второго числа, содержит значения (1 набор) кинетических параметров, или фенотип 1 особи генетического алгоритма.</p>
<p>Первый параметр в строке - это значение целевой функции для данного набор параметров.</p>
<p>Также первый параметр может быть равен "-1". Это означает, что значений целевой функции для данного набор кинетических параметров еще неизвестно. Программа, начинающая расчет с использованием save-файла (мы говорим просто: с save-файла), до начала итерационного процесса выполнит расчет значений целевой функции для таких наборов кинетических параметров. Таким образом, возможно решение прямой кинетической задачи вне решения обратной кинетической задачи (см. <a class="el" href="usage.html#forward_problem">Решение прямых задач</a>).</p>
<div class="fragment"><div class="line">7 12 0.01 file1.txt gas.inp mech.inp 4 8 10 4 65 20 120</div><div class="line">4.179 6.32479</div><div class="line">11.64 7.94628</div><div class="line">24.179 7.9707</div><div class="line">24.191 8.33453</div></div><!-- fragment --><p>Этот save-файл записан после 7 итерации из 10 ГА подбора 1 параметра, ГА запущен с 4 особями и 4 дочерними особями. Всего программа использует 8 потоков исполнения, так что на каждой итерации для всех особей можно производить вычисление целевой функции одновременно.</p>
<h2><a class="anchor" id="use1_4"></a>
Синтаксис файла с кинетическим механизмом (газофазные реакции)</h2>
<p>Синтаксис этого файла соответствует формату "CHEMKIN - II input file" <a class="el" href="citelist.html#CITEREF_keechemkinmain">[4]</a></p>
<p>Пример (для реакции CO и O2 на платинородиевом катализаторе): </p><div class="fragment"><div class="line">ELEMENTS</div><div class="line">O C Pt Rh</div><div class="line">END</div><div class="line">SPECIES</div><div class="line">CO O2 CO2 N2</div><div class="line">END</div></div><!-- fragment --><p> Заметим, что элементы перечисляются только для активных (участвующих в реакциях) веществ, а атомарный азот не включается в список, поскольку азот N2 - это инерт, газ-носитель. Кроме того, мы видим, что здесь перечисляются и элементы катализатора. Это делается, так как они объявлены в составе поверхностных частиц (см. <a class="el" href="usage.html#use1_6">Синтаксис файла с термодинамическими данными (поверхностные частицы)</a>), и участвуют в реакции.</p>
<h2><a class="anchor" id="use1_5"></a>
Синтаксис файла с кинетическим механизмом (поверхностные реакции)</h2>
<p>Синтаксис этого файла соответствует формату "Surface CHEMKIN - II input file" <a class="el" href="citelist.html#CITEREF_keechemkin">[3]</a>, и имеет также несколько дополнений.</p>
<p>Имя по умолчанию - mech.inp.</p>
<p>В этом файле указываются все реакции. Каждая строка реакции предваряется указателем номера, например, !#1.</p>
<p>Нумеровать реакции следует последовательно от единицы.</p>
<div class="fragment"><div class="line">MATERIAL TWC3</div><div class="line">SITE/PLATINUM/    SDEN/2.07E-9/</div><div class="line">Pt(S) O(S) CO2(S) CO(S) C(S) NO(S) N(S) N2O(S)</div><div class="line">END</div><div class="line">!ALIAS (S) Pt:1</div><div class="line">THERMO ALL</div><div class="line">   300.0   1000.0   5000.0</div><div class="line">CO                121286C   1O   1          G  0300.00   5000.00  1000.00      1</div><div class="line">0.03025078E+02 0.01442689E-01-0.05630828E-05 0.01018581E-08-0.06910952E-13    2</div><div class="line">-0.01426835E+06 0.06108218E+02 0.03262452E+02 0.01511941E-01-0.03881755E-04    3</div><div class="line">0.05581944E-07-0.02474951E-10-0.01431054E+06 0.04848897E+02                   4</div><div class="line">.....</div><div class="line">.....</div><div class="line">Pt(S)  REF ELEME  T08/10PT 1.   0.   0.   0.S   298.150  2042.000 1000.        1</div><div class="line"> 2.85793043E+00 1.02169438E-03-5.90389244E-07 2.63911729E-10-5.65925560E-15    2</div><div class="line">-8.95793150E+02-1.15728164E+01 2.60343622E+00 2.37670693E-03-3.28073455E-06    3</div><div class="line">2.61765836E-09-7.69578918E-13-8.57676172E+02-1.04182748E+01 0.00000000E+00    4</div><div class="line">END</div><div class="line">REACTIONS   KJOULES/MOLE</div><div class="line">!**************** TC residuals *****************</div><div class="line">! Reaction 1 for deltaH 1.04257e+06</div><div class="line">...</div><div class="line">! Total for deltaH: 7.04801e+06</div><div class="line">! Total for deltaS: 65.402</div><div class="line">! Total for deltaG: 3.28243e+07</div><div class="line">!***********************************************</div><div class="line">!<span class="preprocessor">#1</span></div><div class="line">Pt(S) + CO =&gt; CO(S)  8.591465e-01 0.000000e+00 0.000000e+00</div><div class="line"> STICK</div><div class="line"> .....</div><div class="line"> .....</div><div class="line">END</div></div><!-- fragment --><ul>
<li>В первой строке указывается название материала: например, MATERIAL TWC3.</li>
<li>Секция SITE дожна содержать указание всех поверхностных частиц <div class="fragment"><div class="line">Pt(S) O(S) CO2(S) CO(S) C(S) NO(S) N(S) N2O(S) </div></div><!-- fragment --> Указанное здесь общее число активных центров SDEN не играет роли. <em>mech_optimiz</em> CSTRCASCADE передает эту информацию с учетом информации из экспериментальной точки в Cantera внутри программы <em>mech_optimiz</em>.</li>
<li>С '!' начинается комментарий. Дополнительные ключевые слова, не используемые CHEMKIN, для обратной совместимости являются комментариями.</li>
<li>ALIAS позволяет задать, какое количество активных центров (здесь принимается равным числу атомов некоторого вещества) занимают частицы данного типа. Например, запись<div class="fragment"><div class="line">!ALIAS (S) Pt:1 </div></div><!-- fragment --> указывает, что все частицы, содержащие (S) в конце названия, содержат 1 атом платины (занимают 1 активный центр на платине). <br />
 Таким образом, если вы хотите объявить частицу \(C_2H_4*\), занимающую два активных центра, вы создаете псевдоним S1: <div class="fragment"><div class="line">!ALIAS (S) Pt:1 (S1) Pt:2 </div></div><!-- fragment --> Частицу при этом следует назвать C2H4(S1). <dl class="section note"><dt>Заметки</dt><dd>Информация о числе активных центров, занимаемых адсорбатами, автоматически передается Cantera при ее использовании.</dd></dl>
</li>
<li>Секция THERMO ALL должна содержать объявление всех частиц, для которых термодинамические свойства считаются известными. Это:</li>
<li>газофазные частицы (также, они могут быть объявлены в файле thermo.dat);</li>
<li>частицы, относящихся к чистому катализатору (не всегда). Чтобы не использовать несколько файлов с термодинамическими свойствами, удобнее перенести объявления газофазных частиц из thermo.dat в секцию THERMO ALL настоящего файла. <br />
 Секция заканчивается ключевым словом 'END'.</li>
<li>Далее, обязательно следует объявление REACTIONS KJOULES/MOLE</li>
<li>второй столбец содержит информацию о единицах, в которых в файле приводится энергии активации реакционных стадий.</li>
<li>Строки записи кинетической стадии: <div class="fragment"><div class="line">Pt(S) + CO =&gt; CO(S)  8.591465e-01 0.000000e+00 0.000000e+00</div><div class="line"> STICK</div></div><!-- fragment --></li>
<li>Первый численный параметр - значение предэкспоненциального множителя;</li>
<li>Второй параметр - значение показателя степени при температуре (для стадий адсорбции этот параметр здесь отдельно не выделяется, указывается равным 0.0);</li>
<li>Третий параметр - значение энергии активации. <br />
 Подробнее, см. <a class="el" href="usage.html#ModArrh">ModArrh</a> <br />
 Строка STICK указывается только после стадий адсорбции. Тогда первый параметр (вместо предэкспоненциального множителя) будет распознан как коэффициент вероятности адсорбции, а показатель степени при температуре в уравнении для константы скорости будет эффективно равен 0.5. <br />
 Коэффициенты, учитывающие латеральные взаимодействия могут быть указаны в отдельной строке после любой стадии: <div class="fragment"><div class="line">COV /CO(s) 0 0 30.0/</div></div><!-- fragment --> Указывается вещество, степень покрытия которым поверхности изменяет кинетические параметры, а величина изменение задается с помощью трех численных параметров: \(\eta\), \(\mu\), \(\epsilon\). Параметр \(\epsilon\) наиболее важен, он определяет величину изменения энергии активации при полном заполнении поверхности адсорбатом данного вида. <br />
 Т.е., в примере указано, что при полном заполнении поверхности адсорбатом CO(S) (его доля покрытия, coverage, = 1.0) энергия активации стадии увеличится на 30.0. <br />
 Отрицательные значения свидетельствуют об уменьшении энергии активации кинетической стадии с увеличением степени покрытия поверхности указанным адсорбатом. <br />
 За подробной информацией об их значении обратитесь к документации Surface Chemkin <a class="el" href="citelist.html#CITEREF_keechemkin">[3]</a></li>
<li>TC residuals - комментарий, впечатываемый <em>mech_optimiz</em>, указывает величины невязок по термодинамической согласованности (для отдельных обратимых реакций и суммарные). Присутствие его в файле, подаваемом пользователем на вход <em>mech_optimiz</em>, на расчеты не влияет.</li>
</ul>
<h2><a class="anchor" id="use1_6"></a>
Синтаксис файла с термодинамическими данными (поверхностные частицы)</h2>
<p>Синтаксис этого файла соответствует формату "CHEMKIN - II thermodynamic database file" <a class="el" href="citelist.html#CITEREF_keechemkinthermo">[5]</a></p>
<p>Имя по умолчанию - mech.dat</p>
<dl class="section note"><dt>Заметки</dt><dd>Внимание! Считывание данных из этого файла для использования в программе не реализовано!!!</dd></dl>
<p>В этом файле указываются термодинамические свойства для всех поверхностных частиц, которые встречаются в файле с кинетическим механизмом. Если вы не имеете информации о свойствах некоторой частицы (для большинства частиц они на данный момент не табулированы), заполните коэффициенты в строках нулями. </p><div class="fragment"><div class="line">THERMO</div><div class="line">  300.0   1000.0   3000.0</div><div class="line">O(S)               92491O   1Pt  1          I    300.00   3000.00 1000.00      1</div><div class="line">0.19454180E+01 0.91761647E-03-0.11226719E-06-0.99099624E-10 0.24307699E-13    2</div><div class="line">-0.14005187E+05-0.11531663E+02-0.94986904E+00 0.74042305E-02-0.10451424E-05    3</div><div class="line">-0.61120420E-08 0.33787992E-11-0.13209912E+05 0.36137905E+01                   4</div><div class="line">C2H3O(S)                C   2H   3O   1Pt  1I   300.0    3000.0   1000.0       1</div><div class="line">0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00    2</div><div class="line">0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00    3</div><div class="line">0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00                   4</div><div class="line">END</div></div><!-- fragment --><h2><a class="anchor" id="use1_7"></a>
Синтаксис файла с термодинамическими данными (thermo.dat)</h2>
<p>Синтаксис этого файла соответствует формату "CHEMKIN - II thermodynamic database file" <a class="el" href="citelist.html#CITEREF_keechemkinthermo">[5]</a></p>
<p>В этом файле указываются термодинамические свойства веществ газовой фазы.</p>
<p>Пример: </p><div class="fragment"><div class="line">THERMO</div><div class="line">  300.0   1000.0   3000.0</div><div class="line">H2                121286H   2               G  0300.00   5000.00  1000.00      1</div><div class="line"> 0.02991423E+02 0.07000644E-02-0.05633829E-06-0.09231578E-10 0.01582752E-13    2</div><div class="line">-0.08350340E+04-0.01355110E+02 0.03298124E+02 0.08249442E-02-0.08143015E-05    3</div><div class="line">-0.09475434E-09 0.04134872E-11-0.01012521E+05-0.03294094E+02                   4</div><div class="line">H2O                20387H   2O   1          G  0300.00   5000.00  1000.00      1</div><div class="line"> 0.02672146E+02 0.03056293E-01-0.08730260E-05 0.01200996E-08-0.06391618E-13    2</div><div class="line">-0.02989921E+06 0.06862817E+02 0.03386842E+02 0.03474982E-01-0.06354696E-04    3</div><div class="line"> 0.06968581E-07-0.02506588E-10-0.03020811E+06 0.02590233E+02                   4</div><div class="line">...</div><div class="line">END</div></div><!-- fragment --><p> Первые два числа показывают нижний диапазон температуры, где используются данные термодинамические коэффициенты. Именно <b>коэффициенты нижнего диапазона температур</b> используются <em>mech_optimiz</em> в алгоритме термодинамической непротиворечивости. Если температуры экспериментов лежат вне данного диапазона температур, термодинамическое согласование выполнять нельзя.</p>
<p><a class="anchor" id="thermoTemperatures"></a></p><dl class="section note"><dt>Заметки</dt><dd>Итак, в данном случае (пример выше) база веществ позволяет использовать возможности <em>mech_optimiz</em> по термодинамическому согласованию кинетических параметров, если температуры экспериментов находятся в пределах 300.0-1000.0 K.</dd></dl>
<p>Возможность использования верхнего температурного диапазона будет включена в следующие выпуски программы. Вы можете написать разработчикам, чтобы ускорить имплементации тех возможностей, которые хотели бы видеть в программе именно Вы.</p>
<h2><a class="anchor" id="use1_8"></a>
Синтаксис файла с параметрами алгоритма обеспечения термодинамической непротиворечивости</h2>
<dl class="section note"><dt>Заметки</dt><dd>Файл является также конфигурационным файлом для <a class="el" href="usage.html#use4">задачи типа "THERMCON"</a>.</dd></dl>
<p>Пример файла: </p><div class="fragment"><div class="line">THERMCON</div><div class="line">400 750</div><div class="line">7 3D 0 0 0</div><div class="line">1 1</div><div class="line">2 1 -1</div><div class="line">3 1</div><div class="line">4 1</div><div class="line">5 1 -1</div><div class="line">11 1</div></div><!-- fragment --><p>В первой строке указывается ключевое слово THERMCON.</p>
<p>В первой строке может быть указан также второй параметр: коэффициент масштабирования невязок. На этот коэффициент будут поделены суммарные значения невязок, характеризующие степень термодинамической согласованности кинетических параметров. </p><div class="fragment"><div class="line">THERMCON 1e+08 </div></div><!-- fragment --><p> Значение по умолчанию равно 1e+07. <br />
(indivudal.cpp) </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> lambda_scaling_TC=1.0e+07; </div></div><!-- fragment --><p>Во второй строке указываются границы диапазона температуры (K), на котором будет проверяться и/или обеспечиваться термодинамическая непротиворечивость.</p>
<p>В третьей строке осуществляется управление алгоритмами TC.</p><ul>
<li>7 - число коэффициентов полиномов NASA (не может быть иным на данный момент)</li>
<li>3D - размерность пространства (при использовании решателя CSTRCASCADE - указывать 3D)</li>
<li>0 - dHdSAlg (1 - dGAlg) (<a class="el" href="thermcons.html#TC_main">Термодинамическая непротиворечивость - используемые подходы</a>)</li>
<li>далее идут два необязательных параметра (значения по умолчанию для них: 0 и 5).</li>
<li>4ый параметр позволяет выбрать алгоритм поиска кинетических параметров обратных стадий - dHdS (0) - dG с методом Ньютона + в генетическим алгоритмом в случае ошибки метода Ньютона (dG-NW-GA) (1), dG только с генетическим алгоритмом (dG-GA).</li>
<li>5ый параметр позволяет задать число запусков генетического алгоритма (со второго - с сужением границ). Может быть задано любое неотрицательное число. <dl class="section note"><dt>Заметки</dt><dd>В случае, если задано число 0 (0 запусков ГА), а 4ый параметр равен 1 (dGAlg), то в случае ошибки метода Ньютона значение кинетического параметра будет оставлено на границе диапазона поиска.</dd>
<dd>
Метод Ньютона применяется последовательно к каждой обратной стадии для поиска значений ее кинетических параметров.</dd>
<dd>
В случае, если метод Ньютона выдает ошибку при использовании алгоритма dHdSAlg, значение кинетического параметра также будет оставлено на границе диапазона поиска.</dd>
<dd>
В 4ой строке возможно указывать "FIT_REACTIONS номера_стадий..." для выбора в качестве обратных заданных стадий. Возможно не использовать эту опцию, тогда с 4ой строки начинаются дальнейшие однотипные строки (иначе - с 5ой).</dd></dl>
С 4ой строки указываются:</li>
<li>в первом столбце - номер прямой стадии</li>
<li>во втором столбце - весовой коэффициент для данной обратимой реакции. Большие значения весового коэффициента обеспечивают лучшую термодинамическую согласованность данной реакции (в ущерб другим реакциям).</li>
<li>в третьем столбце (необязательно) можно указывать значение параметра \(\beta\) для обратной стадии. Иначе, значение параметра принимается равным 0, для стадий адсорбции 0.5.</li>
</ul>
<p>Для приведенного выше примера все стадии имеют одинаковые весовые коэффициенты, стадии 2 и 5 имеет специфические значения показателя степени при температуре в модифицированном уравнении Аррениуса \(\beta\) <b>для обратных им стадий</b>, равные -1.</p>
<h2><a class="anchor" id="use1_9"></a>
Другие файлы, которые должны находиться в папке запуска для работы программы</h2>
<h3><a class="anchor" id="use1_9_1"></a>
Файлы, используемые моделью CSTRCASCADE</h3>
<ul>
<li>coolant.xml (обязателен для расчетов с учетом изменения температуры) - содержит свойства хладагента.</li>
</ul>
<h3><a class="anchor" id="use1_9_2"></a>
Общие файлы</h3>
<ul>
<li>element.dat (обязательный) содержит молярные массы химических элементов.</li>
<li>memmntdir.sh (обязательный) - скрипт, обнаруживающий tmpfs на Unix-системе</li>
<li>moveentropy.sh - скрипт, контролирующий сохранение в директорию Entropy файлов со значениями производства энтропии на каждой итерации</li>
<li>moveG.sh (желательный)- скрипт, контролирующий сохранение в директорию Gbest файлов с кинетическим механизмом на каждой итерации</li>
<li>saveconv.sh (желательный) - скрипт, контролирующий сохранение в директорию temp файлов со значениями конверсии по ячейкам реактора</li>
<li>rmentropy.sh - скрипт, контролирующий удаление файлов со значениями производства энтропии на каждой итерации</li>
<li>rmG.sh (желательный) - скрипт, контролирующий удаление файлов с кинетическим механизмом на каждой итерации</li>
<li>viewconv.sh - утилита визуализации графиков конверсии. Требует наличия графического дисплея и установленной программы gnuplot.</li>
</ul>
<h2><a class="anchor" id="use1_10"></a>
Файлы, производимые программой при работе</h2>
<h3><a class="anchor" id="use1_10_1"></a>
Файлы с кинетическими механизмами</h3>
<p>Файлы производятся только при поиске кинетических параметров (режим RKP). <br />
 Файлы с кинетическими механизмами для каждой хромосомы создаются на каждой итерации ГА, но при сохранении всех этих файлов в рабочей директории уже по истечении нескольких сотен итераций ГА скорость работы программы значительно падает. Это связано с тем, что для выполнения некоторых команд оболочки (которые выполняются между итерациями) система осуществляет построение дерева файлов директории, что выполняется крайне медленно при числе файлов более 1000-3000. Поэтому, текущая версия программы <em>mech_optimiz:</em> </p><ol type="1">
<li>Оставляет файлы с кинетическими механизмами только при улучшении функции приспособленности (уменьшении целевой функции);</li>
<li>Делает это только для лучшей особи (1 файл);</li>
<li>Переносит этот файл в директорию Gbest. Файлы с кинетическими механизмами имеют вид <div class="fragment"><div class="line">G-номер_итерации-номер_хромосомы.inp </div></div><!-- fragment -->.</li>
</ol>
<h3><a class="anchor" id="use1_10_2"></a>
Файл со значением критериев подбора</h3>
<p>В файле "criteria.txt" сохраняется информация о значениях критериев, участвующих и не участвующих в подборе.</p>
<p>Файл сохраняется на тех итерациях ГА, где произошло улучшение целевой функции по сравнению с предыдущим лучшим (минимальным) по популяции значением.</p>
<ul>
<li>Во-первых, это критерий, отражающий согласованность модели и эксперимента. Обычно - это критерий по конверсии, или сумма квадратов отклонения данных моделирования от данных эксперимента по конверсии веществ (их число определено в строке CASE для каждой экспериментальной установки - см. <a class="el" href="usage.html#mainSubstances">mainSubstances</a>). <br />
 Однако, в случае использования COVRATIO в этот же критерий включается масштабированное рассогласование по долям покрытия поверхности группами адсорбатов. См. <a class="el" href="usage.html#covratio">covratio</a> <br />
 В файле значения этого критерия выводится после слов: "sum residuals ="</li>
<li>Во-вторых, это критерий по термодинамической непротиворечивости кинетического механизма. После расчета (см. <a class="el" href="thermcons.html#TCResiduals">TCResiduals</a>) он масштабируется в соответствии с коэффициентом, заданном в файле с параметрами алгоритма обеспечения термодинамической непротиворечивости (см. <a class="el" href="usage.html#use1_8">Синтаксис файла с параметрами алгоритма обеспечения термодинамической непротиворечивости</a>). <br />
 В файле значения этого критерия выводится после слов: "td_part ="</li>
<li>В-третьих, это критерий по производству энтропии <br />
 В файле значения этого критерия <b>в масштабированном виде</b> выводится после слов: "entr_part_total =".</li>
</ul>
<p>Значения суммарного производства энтропии во всех ячейках реактора доступны как "entr_prod_react" (рассчитывается по классическим формулам для производства энтропии в системе с химической реакцией в каждой ячейке реактора отдельно) и "-entr_change_external" (рассчитывается по балансовым соотношением как суммарное изменение энтропии в реакторе, взятое с обратным знаком).</p>
<p>Значение показателя "all_converged =" показывает, все ли экспериментальные точки были успешно рассчитаны. Результаты (лучший на итерации кинетический механизм) при значении показателя "all_converged = false" не могут быть признаны годными.</p>
<p>"fitness" показывает значений целевой функции. Целевая функции содержит сумму только "используемых" критериев. Остальные критерии также рассчитываются, но их значения (выводимые в данный файл) имеют информационный характер.</p>
<div class="fragment"><div class="line">iteration 103</div><div class="line">sum residuals = 14.1622  td_part = 1053.51  entr_prod_react = 2.69228e-05  \</div><div class="line">-entr_change_external = 2.68816e-05  entr_part_total = 0.015846 all_converged \</div><div class="line">= <span class="keyword">true</span> fitness = 14.1622</div></div><!-- fragment --><p> Как видно, в данном примере целевая функция составляется только из критерия, отражающего согласованность модели и эксперимента (взято из примера, где критерий рассчитан на основе значений конверсии, т.е., как "критерий по конверсии").</p>
<h3><a class="anchor" id="use1_10_3"></a>
Файл со значением целевой функции</h3>
<p>Имеет название "fitимя_конфигурационного_файла.txt". В нем каждую итерацию сохраняются в виде столбцов следующие значения:</p><ul>
<li>номер итерации</li>
<li>лучшее по популяции значение целевой функции</li>
<li>худшее по популяции значение целевой функции</li>
<li>среднее по популяции значение целевой функции</li>
<li>номер наилучшей особи (той, что соответствует наилучшему значению целевой функции).</li>
</ul>
<p>В первой строке сохраняется заголовок.</p>
<p>Пример: </p><div class="fragment"><div class="line">generation best worst average</div><div class="line">1 1140.22 1160.39 1150.11 0</div></div><!-- fragment --><p> Номер наилучшей особи может быть равен 0, поскольку особи нумеруются от нуля в программе.</p>
<p>По номеру наилучшей особи можно найти файлы, относящиеся к данной особи. Все такие файлы имеют вид "...-номер_итерации_ГА-номер_особи-...". Например, для поверхностного кинетического механизма, названия файлов для которых начинаются с 'G', на итерации 1109 для особи 10 записанный файл с механизмом: </p><div class="fragment"><div class="line">G-1109-10-mech.inp </div></div><!-- fragment --><h3><a class="anchor" id="use1_10_4"></a>
Файлы со значениями экспериментальной конверсии и рассчитанной по модели конверсии</h3>
<p>Сохраняются только для наилучшей особи на итерации, где произошло улучшение целевой функции (по сравнению с предыдущим лучшим значением по популяции).</p>
<p>Название файла содержит номер итерации метку best и номер особи ГА.</p>
<p>Расширение файла - 'csv', но в качестве разделителя использованы пробелы, что воспринимается по умолчанию верно большим числом утилит текстовой обработки.</p>
<p>Сохраняются в папке temp в рабочей директории расчета: </p><div class="fragment"><div class="line">$ cat temp/194-best-19conv-194-19.csv</div><div class="line">0 10 428.35 CO 0 0.000119013 O2 0 0.000134881</div><div class="line">1 10 563.15 CO 10.22 1.80611 O2 18.63 3.98334</div><div class="line">2 10 583.15 CO 29.06 19.1053 O2 52.83 39.6317</div></div><!-- fragment --><p>Номер столбца - описание</p><ul>
<li>1 - номер экспериментальной точки</li>
<li>2 - номер CASE</li>
<li>3 - температура, K</li>
<li>4 и далее (по три столбца): газ, экспериментальное значение конверсии, значение конверсии из моделирования.</li>
</ul>
<h3><a class="anchor" id="use1_10_5"></a>
Файл со значениями целевой функции (всех вычислений)</h3>
<p>В файл objective_evaluation.txt заносится информация о всех вычислениях целевой функции, что позволяет позже построить точную доверительную область (exact confidence region) для оценок параметров.</p>
<h2><a class="anchor" id="use1_11"></a>
Другое</h2>
<h3><a class="anchor" id="fromdb"></a>
Получение и использование кинетических параметров из базы данных реакций</h3>
<p>Диапазон поиска кинетических параметров не может быть выбран произвольно. Следует учитывать экспериментальную, теоретическую информацию, накопленную наукой в области исследований. Для автоматизации возможности хранения информации о кинетических параметрах и выборе границ диапазона поиска была создана база данных реакций на основе mongodb. См. <a class="el" href="dbusage.html">Работа с базой данных реакций</a></p>
<h3><a class="anchor" id="forward_problem"></a>
Решение прямых задач</h3>
<p>Решение прямых (кинетических) задач конечно возможно с помощью ПО для решения обратных задач, поскольку обратная задача предполагает решение множества прямых задач.</p>
<p>Не вводя дополнительные средства решения прямой задачи, мы предлагаем пользователю решать прямую задачу, настраивая специальным образом конфигурационный файл.</p>
<p>Для того чтобы решить прямую кинетическую задачу, поставьте начальный номер итерации, равный максимальному числу итераций в строке параметров запуска.</p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000001">Уст.:</a></b></dt><dd>(этот текст более не актуален и не рекомендуется к использованию, хотя и является работоспособным способом) <code>Шаги</code>, которые следует предпринять для решения прямой кинетической задачи в <em>mech_optimiz:</em> <ol type="1">
<li>Составить конфигурационный файл для задачи, определив обычным образом строку заголовка (с настройками ГА) и экспериментальные точки (CONVERSION). Можно воспользоваться любым готовым файлом, использовавшимся ранее для данной научной задачи для подбора параметров.</li>
<li>В секции параметров <code>PARAMETERS</code> оставить лишь одну запись для любой из реакций, присутствующих в механизме. В ней указать, что будет подбираться один параметр - например, показатель степени \(\beta\) при температуре. Выставить границы поиска параметра вокруг текущего значения Например, для значения \(\beta = 0\) : </li>
</ol>
</dd></dl>
<div class="fragment"><div class="line">26 n y n 0 0 0</div><div class="line">0.0 1e-07</div></div><!-- fragment --><ol type="1">
<li>Число итераций поставить большим на единицу, чем текущий номер итерации.</li>
<li>Вероятность мутации и инверсии поставить равной нулю.</li>
<li>Число особей установить, равным 2 (с 1 хромосомой программа пока не работает, что осталось от первой версии, где основной логической единицей программы был генетический алгоритм) Пример: <div class="fragment"><div class="line">0 12 0.01 pt_FKP.txt gas.inp mech.inp 2 4 1 2 0 0 120</div></div><!-- fragment --> В данном случае, мы говорим, что особи - статичные. <br />
 <em> Статичные особи - есть наборы параметров, для которых надо решить прямую задачу вне решения обратной задачи. Статичные особи позволяют использовать одну и ту же программу с генетическим алгоритмом для расчета обратных задач (нахождение параметров по известным откликам) и прямых задач (нахождение откликов по известным параметрам). В последнем случае выполняется только 1 итерация алгоритма программы без применения генетических операторов. </em></li>
</ol>
<h1><a class="anchor" id="use2"></a>
Режим анализа параметрической чувствительности и идентифицируемости</h1>
<h2><a class="anchor" id="use2_1"></a>
Строка запуска</h2>
<div class="fragment"><div class="line">./mech_optimiz 1 params.txt</div></div><!-- fragment --><ul>
<li>Первый параметр должен быть числом. Если этот параметр равен 0, то запуск решения прямой кинетической задачи для нахождения коэффициентов чувствительности не будет выполняться, а будет проводиться анализ чувствительности по имеющимся файлам. Если хотя бы части файлов нет в наличии, будет выведена соответствующая ошибка.</li>
</ul>
<p>Если параметр не равен 0, будет проведен полный анализ чувствительности с решением прямой кинетической задачи (в коде этот режим обозначен словом <code>from_scratch</code>).</p>
<ul>
<li>Второй параметр позволяет задать имя файла с настройками анализа чувствительности (конфигурационного файла). По умолчанию: 'sensparam.txt'. </li>
</ul>
<h2><a class="anchor" id="use2_2"></a>
Синтаксис конфигурационного файла</h2>
<h3><a class="anchor" id="use2_2_1"></a>
Анализ чувствительности и степеней контроля скорости</h3>
<p>Конфигурационный файл со второй строки представляет собой обычный файл для задачи RKP с объявлением всех температурных точек, на которых нужно выполнить анализ чувствительности. </p><dl class="section note"><dt>Заметки</dt><dd>Секция PARAMETERS не заполняется.</dd></dl>
<p>Рекомендуется использовать экспериментальные точки при температурах из разных участков экспериментального диапазона. Следует выбирать несколько точек для каждой установки (CASE).</p>
<p>Пример: </p><div class="fragment"><div class="line">1</div><div class="line">RKP</div><div class="line">0 12 0.01 sensparam61.txt gas.inp sens_mech.inp 16 28 1 0 0 0 120</div><div class="line">CASE CSTRCASCADE 61 Honeycomb 1D 1 CO CO2 H2 H2O 0.154 0.0 0.0 0.208 He 0.03 0.003 2.36E-08 Pt(S) 1.0 4.2419E-007 1.43E+06 0.35 30 100 120</div><div class="line">CASE CSTRCASCADE 62 Honeycomb 1D 1 CO CO2 H2 H2O 0.055 0.0 0.0 0.208 He 0.03 0.003 2.36E-08 Pt(S) 1.0 2.6228E-007 1.43E+06 0.35 30 100 120</div><div class="line">CONVERSION_mole_fr 61 523.15 1.10</div><div class="line">CONVERSION_mole_fr 62 548.15 3.21</div><div class="line">ADDEQUATIONS dVdVr</div><div class="line">UNITS E KJOULES/MOLE</div><div class="line">PARAMETERS</div></div><!-- fragment --><p>Заметим, что в строке параметров запуска должен быть указано имя, отличное от текущего конфигурационного файла для записи временного файла. В противном случае оригинальный файл будет переписан.</p>
<p>Первая строка файла показывает, на скольких уровнях (levels) изменения параметра будет проведен анализ. Первый уровень - всегда уровень 99%-ной величины параметра (0.99 от величины, данной в файле с кинетическим механизмом).</p>
<p>Остальные уровни равномерно распределяются от \({1/3}\) до \(1{2/3}\), исключая оригинальный уровень (1).</p>
<p>Число уровней всегда должно быть нечетно, в противном случае оно округляется в большую сторону. Пример: </p><div class="fragment"><div class="line">первая строка содержит 8.</div><div class="line">Число уровней: 9.</div><div class="line">Уровни:</div><div class="line">0.99 2/6 3/6 4/6 5/6 7/6 8/6 9/6 10/6</div></div><!-- fragment --><h3><a class="anchor" id="use2_2_2"></a>
Анализ идентифицируемости</h3>
<p>Если режим массивного анализа не включен (см. use2_4), то выполняется анализ параметрической идентифицируемости. Анализируются взаимозависимости между параметрами: строится таблица коэффициентов корреляции, находятся эллиптические доверительные интервалы для каждого из параметров. Также анализ зависимостей между параметрами производится с помощью метода ортогонализации Yao и др. Этот метод превосходит метод корреляций.</p>
<h2><a class="anchor" id="use2_3"></a>
Синтаксис save-файла</h2>
<p>save-файл создается программой автоматически до решения прямой кинетической задачи (название "конфигурационный_файл.txt-0") и по окончании ((название "конфигурационный_файл.txt-1").</p>
<p>Анализ чувствительности работает следующим образом: для всех уровней изменения каждого из параметров создаются строки со значениями параметров. Каждый раз варьируется только один параметр, все остальные остаются на оригинальных значениях. В начало строки дописывается "-1" (значение целевой функции), и строка сохраняется в save-файл. "-1" является условным знаком программе, что для считанного фенотип (набор кинетических параметров) значения целевой функции неизвестно, и необходимо его рассчитать (см. также <a class="el" href="usage.html#use1_3">Синтаксис save-файла</a>).</p>
<p>Пример: <em> -1 0.046 1e+13 26.78 </em> - строка save-файла для анализа чувствительности 3 параметров)</p>
<h2><a class="anchor" id="use2_4"></a>
"Массированный" анализ параметрической чувствительности</h2>
<p>Массированный анализ - это анализ чувствительности и управления скоростью/селективности для множества файлов с кинетическими механизмами.</p><ul>
<li>Запуск массированного анализа осуществляется при выборе анализа параметрической чувствительности как режима работы программы (первый параметр - число), но при этом число параметров равно 3. <div class="fragment"><div class="line">./mech_optimiz 1 n RC</div></div><!-- fragment --></li>
<li>Второй параметр в примере опущен, что означает использование файла настроек sensparam.txt (по умолчанию).</li>
<li>Третий параметр - есть директория (директория массированного анализа), где дожен находиться файл <code>names.txt</code> с названиями файлов с поверхностными кинетическими механизмами, для которых нужно выполнить анализ. В этой же директории будут сохранены все результаты - для каждого варианта механизма создается собственная директория. <br />
 В случае выполнения анализа "со старых файлов" (первый параметр равен 0) для каждого механизма будет вновь использована своя директория с файлами, которая должна присутствовать внутри директории массированного анализа.</li>
</ul>
<h2><a class="anchor" id="use2_5"></a>
Файлы с результатами, создаваемые программой</h2>
<p>Итерационный процесс анализа идентифицируемости включает в себя нахождение матрицы дисперсий-ковариаций, расчет коэффициентов корреляции и последовательное исключение коррелирующих параметров. Сильно коррелирующий параметр - тот, для которого хотя бы один коэффициент корреляции с другим параметром больше 0.8. </p><dl class="section note"><dt>Заметки</dt><dd>На данный момент исключаются не только сильно коррелирующие параметры, но все, пока не останется 2 параметра. Так получается ранжирование параметров по величине идентифицируемости. * Оставление 2 параметров связано с тем, что метод общей корреляции Quaiser and Monnigmann <a class="el" href="citelist.html#CITEREF_quaiser2009systematic">[8]</a> требует пересчета матрицы дисперсий-ковариаций после удаления всех параметров, общая корреляции для которых выше порогового значения, и снижения порога общей корреляции. 2 последних параметра имеют одинаковое значение общей корреляции, и выбрать данным методом более идентифицируемый из них уже нельзя.</dd></dl>
<p>Ранжирование параметров по критерию идентифицируемости осуществляется на первой итерации, когда информационная матрица (или, ее аналог для случая многомерной регрессии) является обратимой, и нахождение матрицы дисперсий-ковариаций становится возможным. До этого каждую итерацию производится исключение нечувствительных параметров. На данный момент используется фиксированный порог чувствительности для значений элементов информационной матрицы, равный 1e-12. Параметр признается нечувствительным, если все элементы строки информационной матрицы, соответствующей параметру, ниже порога чувствительности.</p>
<ul>
<li>ranking_orth.txt - содержит ранжирование чувствительных параметров по методу ортогонализации Yao <a class="el" href="citelist.html#CITEREF_yao2003modeling">[13]</a> Ранжирование от наиболее идентифицируемого к наименее идентифицируемому (величина magnitude снижается). Среди ранжирований является предпочтительным.</li>
<li>ranking_corr.txt - содержит ранжирование чувствительных параметров по методу общей корреляции. Ранжирование от наименее идентифицируемого к наиболее идентифицируемому. Quaiser and Monnigmann <a class="el" href="citelist.html#CITEREF_quaiser2009systematic">[8]</a></li>
<li>not_sensitive.txt - содержит нечувствительные параметры <b>(файлы с ранжированием не содержат этих параметров)</b></li>
<li>correlations.txt - содержит коэффициенты корреляции на каждой итерации алгоритма исключения параметров (метод общей корреляции). Содержит сообщение, когда все значения коэффициентов корреляции становятся ниже уровня сильной корреляции ("0.8 level of
strong correlation passed").</li>
<li>conf_exact.txt - содержат информацию о границах диапазона 5%-увеличения целевой функции на основе построения интерполяционного полинома по всем уровням изменения параметра (их число задается в <code>sensparam.txt</code> или аналоге в первой строке - <a class="el" href="usage.html#use2_1">Строка запуска</a>). <dl class="section note"><dt>Заметки</dt><dd>Используйте число уровней (levels) изменения параметра, большее 2 (число уровней должно быть нечетным, поэтому вводить число 2 не имеет смысла - оно будет округлено до 3). <br />
В случае 1 уровня мы получаем линейную интерполяцию по 2 значениям (оригинальное значение параметра и уровень 99%-ной величины параметра), которая может с низкой точностью предсказать локальный профиль целевой функции, также 5%-ное увеличение может быть предсказано только в одну сторону! (линейная функция не может увеличиваться в 2 стороны от точки). </dd>
<dd>
Точные доверительные интервалы соответствуют точной величине изменения целевой функции, но <b>не</b> относятся к 5%-ным доверительным интервалам в смысле 5%-ного уровня значимости/ 95%-доверительного уровня.</dd></dl>
-confidence_intervals.txt - содержит информацию об асимптотических 5-% ных доверительных интервалах для оценок параметров (двусторонних, неодновременных). Используют t-статистику.</li>
</ul>
<p>Все вышеперечисленные файлы генерируются в двух вариантах: в поддиректории sens/integral находятся результаты интегрального (в целом по реактору) анализа параметрической идентифицируемости (по файлам с конверсией conv-...), а в самой директории sens/ остаются результаты дифференциального (по первому реактору) анализу параметрической идентифицируемости (по файлам с конверсией conv1st-...)</p>
<p>Также в директории sens/ присутствуют:</p><ul>
<li>результаты дифференциального и интегрального (int) анализа степеней контроля (управления) скорости (R-) и селективности (S-). Пример: <div class="fragment"><div class="line">degreeC-R-10-T-726.15-sens.srp</div><div class="line">degreeC-S-10-T-726.15-sens.srp</div><div class="line">degreeC-R-<span class="keywordtype">int</span>-10-T-726.15-sens.srp</div><div class="line">degreeC-S-<span class="keywordtype">int</span>-10-T-726.15-sens.srp</div></div><!-- fragment --> В имена файлов включены:</li>
<li>номер экспериментальной установки <code>CASE</code> (в примере - 10)</li>
<li>значение температуры, K (в примере - 726.15)</li>
<li>файлы, содержащие коэффициенты чувствительности. Из число в точности соответствует числу файлов анализа степеней управления скоростью/селективностью, а имя отличается лишь префиксом: вместо degreeC, префикс chk. Пример: <div class="fragment"><div class="line">chk-R-<span class="keywordtype">int</span>-1011-T-726.15-sens.srp</div></div><!-- fragment --> Все эти файлы имеют внутреннюю структуру: param вещество_1 вещество_2 ... номер_реакции-обозначение_параметра коэфф_1 коэфф_2 ... ... Коэффициенты соответствуют значениям степени управления/коэффициентам чувствительности. <br />
Для степеней управления скоростью в конце файла присутствует секция "Sum XRC", где приводится проверочная информация о сумме степеней управления по всем стадиям реакции (сумма должна быть равна единице) Пример:</li>
</ul>
<div class="fragment"><div class="line">forward_r backward_r CO NO N2O</div><div class="line">1 6 0.001869 0.0014129 0.000868458</div><div class="line">2 7 0 0 0</div><div class="line">3 8 0.0046725 0.00494514 0.00578972</div><div class="line">4 9 0.000934501 -0.0981964 -0.40528</div><div class="line">5 10 0 0 0</div><div class="line">11 12 0.0990571 0.0967835 0.0900301</div><div class="line">13 14 0.899924 0.802526 0.501679</div><div class="line">15 16 0 0.197099 0.807955</div><div class="line">Sum XRC:</div><div class="line"> 1.00646</div><div class="line"> 1.00457</div><div class="line"> 1.00104</div></div><!-- fragment --><ul>
<li>Файлы (рисунки) с результатами анализа путей протекания реакции. Создаются файлы путей протекания реакции для:</li>
<li>каждого химического элемента (источники и стоки этого элемента, его баланс)</li>
<li>каждого значения температуры Пример: <div class="fragment"><div class="line">rpa-O-726.15K.dot.png</div></div><!-- fragment --> Файл содержит граф путей протекания реакции для элемента O при значении температуры 726.15 K.</li>
</ul>
<h1><a class="anchor" id="use3"></a>
Режим анализа данных</h1>
<h2><a class="anchor" id="use3_1"></a>
Строка запуска</h2>
<h2><a class="anchor" id="use3_2"></a>
Синтаксис конфигурационного файла</h2>
<h2><a class="anchor" id="use3_3"></a>
Метод k-средних++ (k-means++)</h2>
<h3><a class="anchor" id="use3_3_1"></a>
Вычисление наилучшего числа кластеров</h3>
<h3><a class="anchor" id="use3_3_2"></a>
Определение наилучшего набора параметров для кластеризации через ГА-оптимизацию суммарного силуэта</h3>
<h2><a class="anchor" id="use3_4"></a>
Метод главных компонент (PCA)</h2>
<p>Для использования метода главных компонент, настройте задачу, как указано в секции <a class="el" href="usage.html#use3_3">Метод k-средних++ (k-means++)</a>, а также используйте общее число итераций, равное номеру текущей итерации, как для решения прямой кинетической задачи (см. <a class="el" href="usage.html#forward_problem">Решение прямых задач</a>)</p>
<h1><a class="anchor" id="use4"></a>
Режим однократного изменения набора параметров с целью обеспечения термодинамической непротиворечивости</h1>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000002">Уст.:</a></b></dt><dd>Режим не рекомендуется к использованию. Последнее тестирование - декабрь 2013. Используйте <a class="el" href="usage.html#forward_problem">Решение прямых задач</a> (устаревший способ) c конфигурационным файлом, где указаны друг за другом строки: </dd></dl>
<div class="fragment"><div class="line"> ENTROPY_PRODUCTION</div><div class="line">y y n </div></div><!-- fragment --><p> При этом директория запуска дожна содержать корректный файл с настройками алгоритма термодинамечской непротиворечивости (mech-tc.txt). Для каждой стадии, обратной указанной в этом файле, (т.е. для обратных стадий, так как в файле указываются прямые стадии) в файле настроек должны быть заданы границы диапазона поиска параметров. </p><dl class="section note"><dt>Заметки</dt><dd>Если вы используете алгоритм <code>dHdS</code> и не указали в конфигурационном файле строку RESPECT_BOUNDARIES, значения границ не важны и не будут использоваться алгоритмом, поэтому, можно задать в этом случае в конфигурационном файле произвольные границы.</dd></dl>
<p>Для оценки кинетических параметров без изменения Заметим, что помимо термодинамического согласования параметров при решении задачи типа RKP, еще начиная с более ранних версий, <em>mech_optimiz</em> получило функциональную возможность термодинамического согласования параметров микрокинетического механизма для конкретного файла с кинетическим механизмом отдельно от подбора кинетических параметров. Эту возможность и реализована при указании в конфигурационном файле типа задачи "THERMCON". </p>
<h2><a class="anchor" id="use4_1"></a>
Строка запуска</h2>
<p>Пример: </p><div class="fragment"><div class="line">./mech_optimiz mech-tc.txt t mech_150.inp n + </div></div><!-- fragment --><ul>
<li>mech-tc.txt - конфигурационный файл (обязательный параметр);</li>
<li>t - указание на запуск в режиме thermcon (обязательный параметр для этого режима);</li>
<li>mech_150.inp - файл с поверхностным кинетическим механизмом, оценка TC которого будет выполняться (по умолчанию - mech.inp);</li>
<li>n - использовать файл с определениями газофазных веществ и газофазным механизмом реакции по умолчанию (gas.inp)</li>
<li>+ - искать термодинамические свойства веществ в файлах с газофазным механизмом реакции и поверхностным механизмом (а не в специальном файле, по умолчанию - thermo.dat). </li>
</ul>
<h2><a class="anchor" id="use4_2"></a>
Синтаксис конфигурационного файла</h2>
<p>Файл является конфигурационном файлом для задачи типа "THERMCON". Этот же файл используется для считывания параметров алгоритма обеспечения термодинамической непротиворечивости при решении задачи типа RKP с термодинамическим согласованием параметров. Для решения используется класс tsolver, который оценивает только несогласованность по стандартному изменению энергии Гиббса (исторически более ранний, чем современный и более широкофункциональный thermoWrap).</p>
<h1><a class="anchor" id="use5"></a>
Режим оптимизации произвольной функции (требует программирования функции)</h1>
<h2><a class="anchor" id="use5_1"></a>
Строка запуска</h2>
<h2><a class="anchor" id="use5_2"></a>
Синтаксис конфигурационного файла</h2>
<h2><a class="anchor" id="use5_3"></a>
Примеры</h2>
<h3><a class="anchor" id="use5_3_1"></a>
Оптимизация функции Растригина</h3>
<h3><a class="anchor" id="use5_3_2"></a>
Нахождение оптимальных коэффициентов зависимости порозности слоя от диаметра частиц по экспериментальным данным</h3>
<h3><a class="anchor" id="use5_3_3"></a>
Подбор коэффициента активности поверхности и загрузки слоя катализатора (активная поверхность / м3 реактора)</h3>
<h1><a class="anchor" id="use6"></a>
Режим тестирования</h1>
<h2><a class="anchor" id="use6_1"></a>
Строка запуска для отключения генерации псевдослучайных чисел</h2>
<p>Для отключения инициализации генератора случайных чисел необходимо указать название конфигурационного файла, начинающееся с TEST/test, при этом, реальное имя файла должно быть написано слитно далее.</p>
<p>Пример: для запуска тестового расчета (одна и та же последовательность чисел в генераторе всегда) с конфигурационным файлом task01.txt используйте команду: </p><div class="fragment"><div class="line">./mech_optimiz TESTtask01.txt</div></div><!-- fragment --> <h2><a class="anchor" id="use6_2"></a>
Строка запуска тестов (для тестирования кода программы)</h2>
<p>Для запуска тестов используйте запуск без параметров: </p><div class="fragment"><div class="line">./mech_optimiz</div></div><!-- fragment --> <h2><a class="anchor" id="use6_3"></a>
Структура тестов. Создание собственных тестов</h2>
<p>Структура тестов описана в модуле тестирования unitTesting.h Каждый новая тест-функция пишется как отдельная функция в указанном модуле, при этом вызов функции добавляется в текст функции <code>startUnitTesting()</code> Пример добавления тест-функции для тестирования метод Ньютона решения системы СНАУ: </p><div class="fragment"><div class="line">total_test_results=addQPair(total_test_results,testSNAENewton()); </div></div><!-- fragment --><p> Каждый тест внутри тест-функции осуществляется путем вызова макроса VERIFY: </p><div class="fragment"><div class="line">VERIFY(result_test==program_result,<span class="stringliteral">&quot;[result agreement]&quot;</span>); </div></div><!-- fragment --><p> Первый параметр макроса дожен быть типа bool, второй параметр - строка в двойных кавычках, текст которой будет выведен на экран (описание теста).</p>
<p>Тестовые данные хранятся в файлах с расширением .data. Их можно считать в многомерный массив из файла с помощью функции readStringTestsFromArray() (получается массив строк) или readNUmericTestsFromArray() (получается массив чисел типа double).</p>
<p>Если файл с тестовыми данными отсутствует, то это засчитывается за 1 непройденный тест. При этом счетчики пройденных/непройденных тестов следует инкрементировать, например, следующим образом: </p><div class="fragment"><div class="line">VERIFY(1==2,<span class="stringliteral">&quot;no &quot;</span>+filename.toStdString()+<span class="stringliteral">&quot; testdata\n&quot;</span>) </div></div><!-- fragment --><h2><a class="anchor" id="use6_4"></a>
Другие функции тестирования</h2>
<h3><a class="anchor" id="use6_4_1"></a>
Анализ покрытия кода</h3>
<p>Добавьте в файл mech_optimiz.pro строку </p><div class="fragment"><div class="line"><span class="preprocessor">#QMAKE_CXXFLAGS += --coverage </span></div></div><!-- fragment --><p> и перекомпилируйте программу. После этого запускайте режим тестирования (./mech_optimiz), а также небольшие расчеты, для сбора информации. Анализ результатов - см. информацию для gcc по code coverage. </p>
<h3><a class="anchor" id="use6_4_2"></a>
Анализ утечек памяти</h3>
<p>Мы рекомендуем тестировать <em>mech_optimiz</em> на утечки памяти после серьезных изменений в коде. Для этого мы используем программу <code>valgrind</code>.</p>
<p>В первую очередь, используйте конфигурационный файл (например, назовем его config1.txt), который запустит программу в режиме RKP на 3-10 итераций.</p>
<p>Анализ утечек памяти (в чистом смысле этого слова), то есть потерь памяти из-за некорректного кода (definitely lost, эта память не может быть освобождена в принципе из-за отсутствия delete и т.п.) производится командой: </p><div class="fragment"><div class="line">valgrind --tool=memcheck --leak-check=full --show-reachable=yes ./mech_optimiz config1.txt 1&gt;lcout.txt 2&gt;lcerr.txt</div></div><!-- fragment --><p>Для понимания результатов проверки, обратитесь к <a href="http://valgrind.org/docs/manual/mc-manual.html">документации valgrind</a>.</p>
<p>Запуск программы для анализа утечек памяти из-за неосвобожденной памяти, которую освободить принципиально возможно (still reachable, то есть, в коде присутствует освобождение памяти, но эти строки кода на данный момент не достигнуты) </p><div class="fragment"><div class="line">valgrind --tool=massif ./mech_optimiz config1.txt 1&gt;msout.txt 2&gt;mserr.txt</div><div class="line">ms_print `ls -tr massif.out* | tail -1`</div></div><!-- fragment --><p>Для понимания результатов проверки, обратитесь к <a href="http://valgrind.org/docs/manual/ms-manual.html">документации valgrind</a>. </p>
<h3><a class="anchor" id="use6_4_3"></a>
Непрерывная интеграция</h3>
<p>Непрерывная интеграция программы пока отсутствует. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Документация по mech_optimiz. Последние изменения: Сб 21 Янв 2017 21:23:52. Создано системой
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
