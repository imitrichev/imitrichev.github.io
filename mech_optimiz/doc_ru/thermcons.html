<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>mech_optimiz: Термодинамическая непротиворечивость кинетических механизмов</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Mech-2.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mech_optimiz
   &#160;<span id="projectnumber">4.4.1</span>
   </div>
   <div id="projectbrief">microkinetic mechanism investigation tool</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Создано системой Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Поиск');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Титульная&#160;страница</span></a></li>
      <li class="current"><a href="pages.html"><span>Описания</span></a></li>
      <li><a href="files.html"><span>Файлы</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Поиск" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('thermcons.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Термодинамическая непротиворечивость кинетических механизмов </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Оглавление</h3>
<ul><li class="level1"><a href="#TC_main">Термодинамическая непротиворечивость - используемые подходы</a></li>
<li class="level1"><a href="#TCAlgReverse">Модификация кинетических параметров обратных стадий</a></li>
</ul>
</div>
<div class="textblock"><p>На данной странице описаны подходы, внедренные в mech_optimiz</p>
<h1><a class="anchor" id="TC_main"></a>
Термодинамическая непротиворечивость - используемые подходы</h1>
<p>Термодинамическая непротиворечивость кинетических параметров в mech_optimiz обеспечивается одним из двух способов:</p><ul>
<li>(1) Алгоритм Deutschmann (см. <a class="el" href="citelist.html#CITEREF_deutschmann2013modeling">[2]</a>)</li>
<li>(2) Наше усовершенствование алгоритма (1) - см. нашу статью (подана в ЖФХ, в случае публикации здесь будет дана doi-ссылка).</li>
</ul>
<p>Алгоритм 1 мы будем называть dGalg, поскольку он опирается на согласование стандартной энергии Гиббса реакций. <br />
 Алгоритм 2 мы будем называть dHdSalg, поскольку он опирается на непротиворечивость стандартных энтропии реакции и изменения энтальпии в ходе реакции.</p>
<p>Суть методов (1) и (2) заключается в следующем. Сначала ищутся коэффициенты полиномов, описывающих термодинамические свойства (стандартные энтропию и изменение энтальпии) поверхностных интермедиатов, которые дают наилучшие (применяется метод наименьших квадратов) - по совпадению с вычисленными с помощью кинетических параметров - зависимости стандартной энергии Гиббса реакции (или, одновременно, стандартных энтропии реакции и изменения энтальпии в случае метода (2)). <br />
 Итак, с одной стороны вычисляется изменение термодинамического свойства в ходе реакции через характеристики частиц-участников, с другой стороны, это изменение вычисляется через связь с кинетическими параметрами (в случае (1) - через связь константы равновесия и энергии Гиббса реакции, в случае (2) дополнительное привлекается соотношение теории переходного состояния о взаимосвязи стандартной энтальпии реакции и энергий активации прямой и обратной стадии). При этом выполняется поиск оптимальных коэффициенты полиномов для описания свойств неизвестных веществ.</p>
<p>Выбор алгоритма (dGAlg / dHdSalg) производится пользователем с помощью третьего параметра третьей строки файла настроек процедуры термодинамического согласования (по умолчанию - mech-tc.txt). Подробнее - см. стр. [Использование mech_optimiz](usage), раздел "Синтаксис файла
с параметрами алгоритма обеспечения термодинамической непротиворечивости".</p>
<p>Когда же оптимальные коэффициенты найдены, оставшееся рассогласование минимизируется путем изменения кинетических параметров обратных стадий (разделение на прямые и обратные стадии для обратимых реакций происходит произвольно или в соответствии с анализом чувствительности/идентифицируемости - выбираются наименее важные стадии). То есть уже кинетика "подгоняется" под термодинамику, определенную на первой стадии алгоритма. Подробнее о применяемых в этом случаях алгоритмах - см. <a class="el" href="thermcons.html#TCAlgReverse">ниже</a>.</p>
<p>Результаты применения алгоритма термодинамической непротиворечивости (невязки по каждой реакции) записываются непосредственно в файл с кинетическим механизмом.</p>
<p>Процедура термодинамического согласования (мы обозначаем ее здесь и в других местах английскими буквами "TC") повторяется несколько раз, до тех пор, пока не будет выполнено заданное число итераций согласования, или очередная итерация не улучшит общую оценку непротиворечивости (суммарное рассогласование не снизится). По умолчанию производится 3 итерации согласования. Число итераций может быть задано в файле настроек термодинамической непротиворечивости (строка 2, параметр 3, опциональный).</p>
<p><a class="anchor" id="TCResiduals"></a>Значения рассогласования по стандартному изменению энергии Гиббса (алгоритм dGAlg), или, в случае алгоритма dHdSAlg, (стандартному изменению энтальпии + температура * стандартной энтропии реакции) по всем реакциям суммируются и образуют оценку термодинамической непротиворечивости.</p>
<p><br />
 Файлы с оцененной величиной термодинамической рассогласованности на каждой итерации (после вычисления коэффициентов термодинамических полиномов) получают имя "имя_файла_кинетического_механизма_данной_хромосомы.inp-номер-итерации-tc". Эти файлы содержат насколько возможно термодинамически согласованные наборы параметров (inp-формат). <br />
 После модификации кинетических параметров обратных стадий имя генерируемого файла "имя_файла_кинетического_механизма_данной_хромосомы.inp-номер-итерации". После окончания нескольких итераций, исходный файл "имя_файла_кинетического_механизма_данной_хромосомы.inp" заменяется наилучшим согласованным вариантом механизма "имя_файла_кинетического_механизма_данной_хромосомы.inp-номер-лучшей-итерации-tc".</p>
<h1><a class="anchor" id="TCAlgReverse"></a>
Модификация кинетических параметров обратных стадий</h1>
<p>При поиске кинетических параметров обратных стадий можно брать в качестве критерия минимальное рассогласование по типу (1) (сумма квадратов рассогласований по изменению энергии Гиббса) или (2) (сумма квадратов рассогласований по изменению энтальпии + температура * сумма квадратов рассогласований по энтропии реакции).</p>
<p>При использовании любого алгоритма (dGAlg / dHdSalg) при подборе коэффициентов термодинамических полиномов, пользователь получает возможность подбора кинетических параметров обратных стадий не только через минимизацию соответствующего типу алгоритма рассогласования, но и двумя другими способами, а также их комбинацией. <br />
 В файле mech-tc.txt за выбор типа алгоритма отвечают 4 и 5 параметр (опциональные) в третьей строке. Подробнее см. стр. [Использование mech_optimiz](usage), раздел "Синтаксис файла
с параметрами алгоритма обеспечения термодинамической непротиворечивости".</p>
<p><b> Алгоритмы поиска кинетических параметров обратных стадий.</b> <br />
 Существует два основных алгоритма модификации кинетических параметров обратных стадий: <code>dHdS</code> и <code>dG</code>. Первый алгоритм логичнее применять, когда коэффициенты полиномов NASA \(a_{li}\) для веществ с неизвестными \(\delta H(T)\), \(\delta S(T)\) находились путем минимизация рассогласования между \(\delta H(T)\) и \(\delta S(T)\) для каждой стадии, полученных через кинетические параметры и через свойства индивидуальных частиц, записанные в формате полиномов NASA с 7 коэффициентами. Второй - когда минимизировалось только общее рассогласование по изменению энергии Гиббса. Тем не менее, мы предоставляем пользователю возможность выбора алгоритма, поскольку их работа на одной задаче приводит к близким по уровню рассогласования результатам, но скорость их может отличаться. <br />
 Алгоритм dHdS использует точные формулы, полученные с помощью метода наименьших квадратов, для поиска параметров <em>A</em>, <em>E</em>. Таким образом, он однозначно является самым быстрым алгоритмом поиском параметров обратных стадий. Однако текущая имплементация не позволяет выполнять поиск параметра \(\beta\): он</p><ol type="1">
<li>либо задается пользователем в третьем столбце файла настроек термодинамической непротиворечивости для соответствующей обратимой стадии;</li>
<li>либо принимается по умолчанию равным 0 (0.5 для стадий адсорбции): <div class="fragment"><div class="line">newBeta=mech1-&gt;isReactionStick(rrnums[k])?0.5:0.0; </div></div><!-- fragment --></li>
</ol>
<p>Алгоритм dG использует метод Ньютона, который выполняет итерационный поиск, и, соответственно, время решения у алгоритма больше, чем у первого. Метод Ньютона здесь применяется для решения система нелинейных уравнений относительно неизвестных кинетических параметров. Метод иногда расходится (несмотря на то, что его текущая реализация предусматривает несколько повторов с выбором начального приближения и изменением величины шага), и тогда нужно применять более мощный метод. <br />
 В качестве замены методу Ньютона применяется бинарный генетический алгоритм со сжимающимися границами, способный найти решение с высокой точностью. Сжатие границ означает сужение диапазона поиска и повышение разрешающей способности. <br />
 Причина использования бинарного ГА - принцип переиспользования кода - один и тот же ГА используется как для подбора кинетических параметров, так и для поиска параметров обратных стадий при термодинамическом согласовании параметров. Заметим, что для этого запускается вложенная подпрограмма основного модуля оптимизации, которому на вход, как обычно подается файл с настройками (каждый раз) и save-файл (со второго этапа, то есть, первого "сжатия границ"). В файле настроек вместо типа задачи <code>RKP</code> указывается <code>THERMCONAE</code>. Эти файлы программа создает сама в автоматическом режиме. <br />
 Необходимо заметить, что генетический алгоритм высокого разрешения (локальный поиск) требует большего количества итераций/вычислений, и скорость работы по сравнению с методом Ньютона ниже в сотни раз. Скорость работы программы на современном четырехъядерном компьютере (Intel Core i7) составляет примерно 400 итераций ГА поиска кинетических параметров в час для поиска 30 кинетических параметров, 350 итераций в час - при использовании алгоритма <code>TC</code> <code>dHdSalg</code> + <code>dHdS</code>. При использовании вместо <code>dHdS</code> алгоритма <code>dG</code> только с методом Ньютона скорость падает до 200 итераций в час, а при использовании <code>dG-ГА</code> - до 50-70 итераций в час. \Следует заметить и то, что метод <code>ГА</code> гарантированно находит оптимальное решение подбора кинетических параметров (в том числе - параметра \(\beta\)) обратных стадий, при этом строго соблюдая границы поиска. <br />
 О выборе алгоритма - см. <a class="el" href="usage.html#use1_8">Синтаксис файла с параметрами алгоритма обеспечения термодинамической непротиворечивости</a> (синтаксис третьей строки файла). </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Документация по mech_optimiz. Последние изменения: Сб 21 Янв 2017 21:23:52. Создано системой
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
